-- start_ignore
create schema dml_functional_no_setup_1;
set search_path to dml_functional_no_setup_1;
-- end_ignore
-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_char;
NOTICE:  table "changedistpolicy_dml_pttab_char" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_char
(
    col1 char,
    col2 char,
    col3 char,
    col4 char,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY LIST(col2)(partition partone VALUES('a','b','c','d','e','f','g','h') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo VALUES('i','j','k','l','m','n','o','p') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree VALUES('q','r','s','t','u','v','w','x'));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_char_1_prt_partone" for table "changedistpolicy_dml_pttab_char"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_char_1_prt_parttwo" for table "changedistpolicy_dml_pttab_char"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_char_1_prt_partthree" for table "changedistpolicy_dml_pttab_char"
INSERT INTO changedistpolicy_dml_pttab_char VALUES('g','g','a','g',0);
SELECT * FROM changedistpolicy_dml_pttab_char ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | g    |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_char SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_char SELECT 'a', 'a','b', 'a', 1;
SELECT * FROM changedistpolicy_dml_pttab_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | a    | b    | a    |    1
 g    | g    | a    | g    |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_char SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | a    | c    | a    |    1
 g    | g    | a    | g    |    0
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_char WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | g    |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_date;
NOTICE:  table "changedistpolicy_dml_pttab_date" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_date
(
    col1 date,
    col2 date,
    col3 char,
    col4 date,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start('2013-12-01') end('2013-12-31') WITH(APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start('2013-12-31') end('2014-01-01') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start('2014-01-01') end('2014-02-01'));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_date_1_prt_partone" for table "changedistpolicy_dml_pttab_date"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_date_1_prt_parttwo" for table "changedistpolicy_dml_pttab_date"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_date_1_prt_partthree" for table "changedistpolicy_dml_pttab_date"
INSERT INTO changedistpolicy_dml_pttab_date VALUES('2013-12-30','2013-12-30','a','2013-12-30',0);
SELECT * FROM changedistpolicy_dml_pttab_date ORDER BY 1,2,3,4;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_date SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_date SELECT '2014-01-01', '2014-01-01','b', '2014-01-01', 1;
SELECT * FROM changedistpolicy_dml_pttab_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
 01-01-2014 | 01-01-2014 | b    | 01-01-2014 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_date SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
 01-01-2014 | 01-01-2014 | c    | 01-01-2014 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_date WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_decimal;
NOTICE:  table "changedistpolicy_dml_pttab_decimal" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_decimal
(
    col1 decimal,
    col2 decimal,
    col3 char,
    col4 decimal,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start(1.00) end(10.00)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10.00) end(20.00) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20.00) end(30.00));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_decimal_1_prt_partone" for table "changedistpolicy_dml_pttab_decimal"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_decimal_1_prt_parttwo" for table "changedistpolicy_dml_pttab_decimal"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_decimal_1_prt_partthree" for table "changedistpolicy_dml_pttab_decimal"
INSERT INTO changedistpolicy_dml_pttab_decimal VALUES(2.00,2.00,'a',2.00,0);
SELECT * FROM changedistpolicy_dml_pttab_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 2.00 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_decimal SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_decimal SELECT 1.00, 1.00,'b', 1.00, 1;
SELECT * FROM changedistpolicy_dml_pttab_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 1.00 | b    | 1.00 |    1
 2.00 | 2.00 | a    | 2.00 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_decimal SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 1.00 | c    | 1.00 |    1
 2.00 | 2.00 | a    | 2.00 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_decimal WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 2.00 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_float;
NOTICE:  table "changedistpolicy_dml_pttab_float" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_float
(
    col1 float,
    col2 float,
    col3 char,
    col4 float,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start(1.00) end(10.00)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10.00) end(20.00) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20.00) end(30.00));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_float_1_prt_partone" for table "changedistpolicy_dml_pttab_float"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_float_1_prt_parttwo" for table "changedistpolicy_dml_pttab_float"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_float_1_prt_partthree" for table "changedistpolicy_dml_pttab_float"
INSERT INTO changedistpolicy_dml_pttab_float VALUES(2.00,2.00,'a',2.00,0);
SELECT * FROM changedistpolicy_dml_pttab_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    2 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_float SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_float SELECT 1.00, 1.00,'b', 1.00, 1;
SELECT * FROM changedistpolicy_dml_pttab_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    1 | b    |    1 |    1
    2 |    2 | a    |    2 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_float SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    1 | c    |    1 |    1
    2 |    2 | a    |    2 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_float WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    2 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_int;
NOTICE:  table "changedistpolicy_dml_pttab_int" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_int
(
    col1 int,
    col2 int,
    col3 char,
    col4 int,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start(1) end(10001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10001) end(20001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20001) end(30001));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int_1_prt_partone" for table "changedistpolicy_dml_pttab_int"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int_1_prt_parttwo" for table "changedistpolicy_dml_pttab_int"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int_1_prt_partthree" for table "changedistpolicy_dml_pttab_int"
INSERT INTO changedistpolicy_dml_pttab_int VALUES(10000,10000,'a',10000,0);
SELECT * FROM changedistpolicy_dml_pttab_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_int SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_int SELECT 20000, 20000,'b', 20000, 1;
SELECT * FROM changedistpolicy_dml_pttab_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
 20000 | 20000 | b    | 20000 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_int SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
 20000 | 20000 | c    | 20000 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_int WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_int4;
NOTICE:  table "changedistpolicy_dml_pttab_int4" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_int4
(
    col1 int4,
    col2 int4,
    col3 char,
    col4 int4,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start(1) end(100000001)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(100000001) end(200000001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(200000001) end(300000001));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int4_1_prt_partone" for table "changedistpolicy_dml_pttab_int4"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int4_1_prt_parttwo" for table "changedistpolicy_dml_pttab_int4"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int4_1_prt_partthree" for table "changedistpolicy_dml_pttab_int4"
INSERT INTO changedistpolicy_dml_pttab_int4 VALUES(20000000,20000000,'a',20000000,0);
SELECT * FROM changedistpolicy_dml_pttab_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 20000000 | 20000000 | a    | 20000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_int4 SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_int4 SELECT 10000000, 10000000,'b', 10000000, 1;
SELECT * FROM changedistpolicy_dml_pttab_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 10000000 | b    | 10000000 |    1
 20000000 | 20000000 | a    | 20000000 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_int4 SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 10000000 | c    | 10000000 |    1
 20000000 | 20000000 | a    | 20000000 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_int4 WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 20000000 | 20000000 | a    | 20000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_int8;
NOTICE:  table "changedistpolicy_dml_pttab_int8" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_int8
(
    col1 int8,
    col2 int8,
    col3 char,
    col4 int8,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start(1) end(1000000000000000001)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(1000000000000000001) end(2000000000000000001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(2000000000000000001) end(3000000000000000001));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int8_1_prt_partone" for table "changedistpolicy_dml_pttab_int8"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int8_1_prt_parttwo" for table "changedistpolicy_dml_pttab_int8"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_int8_1_prt_partthree" for table "changedistpolicy_dml_pttab_int8"
INSERT INTO changedistpolicy_dml_pttab_int8 VALUES(200000000000000000,200000000000000000,'a',200000000000000000,0);
SELECT * FROM changedistpolicy_dml_pttab_int8 ORDER BY 1,2,3,4;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 200000000000000000 | 200000000000000000 | a    | 200000000000000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_int8 SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_int8 SELECT 1000000000000000000, 1000000000000000000,'b', 1000000000000000000, 1;
SELECT * FROM changedistpolicy_dml_pttab_int8 ORDER BY 1,2,3;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
  200000000000000000 |  200000000000000000 | a    |  200000000000000000 |    0
 1000000000000000000 | 1000000000000000000 | b    | 1000000000000000000 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_int8 SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_int8 ORDER BY 1,2,3;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
  200000000000000000 |  200000000000000000 | a    |  200000000000000000 |    0
 1000000000000000000 | 1000000000000000000 | c    | 1000000000000000000 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_int8 WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_int8 ORDER BY 1,2,3;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 200000000000000000 | 200000000000000000 | a    | 200000000000000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_interval;
NOTICE:  table "changedistpolicy_dml_pttab_interval" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_interval
(
    col1 interval,
    col2 interval,
    col3 char,
    col4 interval,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start('1 sec') end('1 min')  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start('1 min') end('1 hour') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start('1 hour') end('12 hours'));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_interval_1_prt_partone" for table "changedistpolicy_dml_pttab_interval"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_interval_1_prt_parttwo" for table "changedistpolicy_dml_pttab_interval"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_interval_1_prt_partthree" for table "changedistpolicy_dml_pttab_interval"
INSERT INTO changedistpolicy_dml_pttab_interval VALUES('10 secs','10 secs','a','10 secs',0);
SELECT * FROM changedistpolicy_dml_pttab_interval ORDER BY 1,2,3,4;
   col1    |   col2    | col3 |   col4    | col5 
-----------+-----------+------+-----------+------
 @ 10 secs | @ 10 secs | a    | @ 10 secs |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_interval SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_interval SELECT '11 hours', '11 hours','b', '11 hours', 1;
SELECT * FROM changedistpolicy_dml_pttab_interval ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 @ 10 secs  | @ 10 secs  | a    | @ 10 secs  |    0
 @ 11 hours | @ 11 hours | b    | @ 11 hours |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_interval SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_interval ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 @ 10 secs  | @ 10 secs  | a    | @ 10 secs  |    0
 @ 11 hours | @ 11 hours | c    | @ 11 hours |    1
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_interval WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_interval ORDER BY 1,2,3;
   col1    |   col2    | col3 |   col4    | col5 
-----------+-----------+------+-----------+------
 @ 10 secs | @ 10 secs | a    | @ 10 secs |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_numeric;
NOTICE:  table "changedistpolicy_dml_pttab_numeric" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_numeric
(
    col1 numeric,
    col2 numeric,
    col3 char,
    col4 numeric,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start(1.000000) end(10.000000)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10.000000) end(20.000000) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20.000000) end(30.000000));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_numeric_1_prt_partone" for table "changedistpolicy_dml_pttab_numeric"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_numeric_1_prt_parttwo" for table "changedistpolicy_dml_pttab_numeric"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_numeric_1_prt_partthree" for table "changedistpolicy_dml_pttab_numeric"
INSERT INTO changedistpolicy_dml_pttab_numeric VALUES(2.000000,2.000000,'a',2.000000,0);
SELECT * FROM changedistpolicy_dml_pttab_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 2.000000 | 2.000000 | a    | 2.000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_numeric SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_numeric SELECT 1.000000, 1.000000,'b', 1.000000, 1;
SELECT * FROM changedistpolicy_dml_pttab_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 1.000000 | b    | 1.000000 |    1
 2.000000 | 2.000000 | a    | 2.000000 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_numeric SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 1.000000 | c    | 1.000000 |    1
 2.000000 | 2.000000 | a    | 2.000000 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_numeric WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 2.000000 | 2.000000 | a    | 2.000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_time;
NOTICE:  table "changedistpolicy_dml_pttab_time" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_time
(
    col1 time,
    col2 time,
    col3 char,
    col4 time,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start('12:00:00') end('18:00:00')  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start('18:00:00') end('24:00:00') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start('0:00:00') end('11:00:00'));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_time_1_prt_partthree" for table "changedistpolicy_dml_pttab_time"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_time_1_prt_partone" for table "changedistpolicy_dml_pttab_time"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_time_1_prt_parttwo" for table "changedistpolicy_dml_pttab_time"
INSERT INTO changedistpolicy_dml_pttab_time VALUES('12:00:00','12:00:00','a','12:00:00',0);
SELECT * FROM changedistpolicy_dml_pttab_time ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_time SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_time SELECT '1:00:00', '1:00:00','b', '1:00:00', 1;
SELECT * FROM changedistpolicy_dml_pttab_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 01:00:00 | 01:00:00 | b    | 01:00:00 |    1
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_time SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 01:00:00 | 01:00:00 | c    | 01:00:00 |    1
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_time WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_timestamp;
NOTICE:  table "changedistpolicy_dml_pttab_timestamp" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_timestamp
(
    col1 timestamp,
    col2 timestamp,
    col3 char,
    col4 timestamp,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start('2013-12-01 12:00:00') end('2013-12-31 12:00:00') WITH(APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start('2013-12-31 12:00:00') end('2014-01-01 12:00:00') inclusive WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start('2014-01-02 12:00:00') end('2014-02-01 12:00:00'));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_timestamp_1_prt_partone" for table "changedistpolicy_dml_pttab_timestamp"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_timestamp_1_prt_parttwo" for table "changedistpolicy_dml_pttab_timestamp"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_timestamp_1_prt_partthree" for table "changedistpolicy_dml_pttab_timestamp"
INSERT INTO changedistpolicy_dml_pttab_timestamp VALUES('2013-12-30 12:00:00','2013-12-30 12:00:00','a','2013-12-30 12:00:00',0);
SELECT * FROM changedistpolicy_dml_pttab_timestamp ORDER BY 1,2,3,4;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_timestamp SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_timestamp SELECT '2014-01-01 12:00:00', '2014-01-01 12:00:00','b', '2014-01-01 12:00:00', 1;
SELECT * FROM changedistpolicy_dml_pttab_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
 Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014 | b    | Wed Jan 01 12:00:00 2014 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_timestamp SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
 Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014 | c    | Wed Jan 01 12:00:00 2014 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_timestamp WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_pttab_timestamptz;
NOTICE:  table "changedistpolicy_dml_pttab_timestamptz" does not exist, skipping
CREATE TABLE changedistpolicy_dml_pttab_timestamptz
(
    col1 timestamptz,
    col2 timestamptz,
    col3 char,
    col4 timestamptz,
    col5 int
) DISTRIBUTED BY (col1) PARTITION BY RANGE(col2)(partition partone start('2013-12-01 12:00:00 PST') end('2013-12-31 12:00:00 PST') WITH(APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start('2013-12-31 12:00:00 PST') end('2014-01-01 12:00:00 PST') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start('2014-01-01 12:00:00 PST') end('2014-02-01 12:00:00 PST'));
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_timestamptz_1_prt_partone" for table "changedistpolicy_dml_pttab_timestamptz"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_timestamptz_1_prt_parttwo" for table "changedistpolicy_dml_pttab_timestamptz"
NOTICE:  CREATE TABLE will create partition "changedistpolicy_dml_pttab_timestamptz_1_prt_partthree" for table "changedistpolicy_dml_pttab_timestamptz"
INSERT INTO changedistpolicy_dml_pttab_timestamptz VALUES('2013-12-30 12:00:00 PST','2013-12-30 12:00:00 PST','a','2013-12-30 12:00:00 PST',0);
SELECT * FROM changedistpolicy_dml_pttab_timestamptz ORDER BY 1,2,3,4;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
(1 row)

ALTER TABLE changedistpolicy_dml_pttab_timestamptz SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_pttab_timestamptz SELECT '2014-01-01 12:00:00 PST', '2014-01-01 12:00:00 PST','b', '2014-01-01 12:00:00 PST', 1;
SELECT * FROM changedistpolicy_dml_pttab_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
 Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST | b    | Wed Jan 01 12:00:00 2014 PST |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_pttab_timestamptz SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_pttab_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
 Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST | c    | Wed Jan 01 12:00:00 2014 PST |    1
(2 rows)

DELETE FROM changedistpolicy_dml_pttab_timestamptz WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_pttab_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_char;
NOTICE:  table "changedistpolicy_dml_regtab_char" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_char
(
    col1 char,
    col2 char,
    col3 char,
    col4 char,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_char VALUES('g','g','a','g',0);
SELECT * FROM changedistpolicy_dml_regtab_char ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | g    |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_char SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_char SELECT 'a', 'a','b', 'a', 1;
SELECT * FROM changedistpolicy_dml_regtab_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | a    | b    | a    |    1
 g    | g    | a    | g    |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_char SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | a    | c    | a    |    1
 g    | g    | a    | g    |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_char WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | g    |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_date;
NOTICE:  table "changedistpolicy_dml_regtab_date" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_date
(
    col1 date,
    col2 date,
    col3 char,
    col4 date,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_date VALUES('2013-12-30','2013-12-30','a','2013-12-30',0);
SELECT * FROM changedistpolicy_dml_regtab_date ORDER BY 1,2,3,4;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_date SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_date SELECT '2014-01-01', '2014-01-01','b', '2014-01-01', 1;
SELECT * FROM changedistpolicy_dml_regtab_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
 01-01-2014 | 01-01-2014 | b    | 01-01-2014 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_date SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
 01-01-2014 | 01-01-2014 | c    | 01-01-2014 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_date WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_decimal;
NOTICE:  table "changedistpolicy_dml_regtab_decimal" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_decimal
(
    col1 decimal,
    col2 decimal,
    col3 char,
    col4 decimal,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_decimal VALUES(2.00,2.00,'a',2.00,0);
SELECT * FROM changedistpolicy_dml_regtab_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 2.00 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_decimal SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_decimal SELECT 1.00, 1.00,'b', 1.00, 1;
SELECT * FROM changedistpolicy_dml_regtab_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 1.00 | b    | 1.00 |    1
 2.00 | 2.00 | a    | 2.00 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_decimal SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 1.00 | c    | 1.00 |    1
 2.00 | 2.00 | a    | 2.00 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_decimal WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 2.00 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_float;
NOTICE:  table "changedistpolicy_dml_regtab_float" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_float
(
    col1 float,
    col2 float,
    col3 char,
    col4 float,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_float VALUES(2.00,2.00,'a',2.00,0);
SELECT * FROM changedistpolicy_dml_regtab_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    2 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_float SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_float SELECT 1.00, 1.00,'b', 1.00, 1;
SELECT * FROM changedistpolicy_dml_regtab_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    1 | b    |    1 |    1
    2 |    2 | a    |    2 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_float SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    1 | c    |    1 |    1
    2 |    2 | a    |    2 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_float WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    2 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_int;
NOTICE:  table "changedistpolicy_dml_regtab_int" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_int
(
    col1 int,
    col2 int,
    col3 char,
    col4 int,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_int VALUES(10000,10000,'a',10000,0);
SELECT * FROM changedistpolicy_dml_regtab_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_int SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_int SELECT 20000, 20000,'b', 20000, 1;
SELECT * FROM changedistpolicy_dml_regtab_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
 20000 | 20000 | b    | 20000 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_int SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
 20000 | 20000 | c    | 20000 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_int WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_int4;
NOTICE:  table "changedistpolicy_dml_regtab_int4" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_int4
(
    col1 int4,
    col2 int4,
    col3 char,
    col4 int4,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_int4 VALUES(20000000,20000000,'a',20000000,0);
SELECT * FROM changedistpolicy_dml_regtab_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 20000000 | 20000000 | a    | 20000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_int4 SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_int4 SELECT 10000000, 10000000,'b', 10000000, 1;
SELECT * FROM changedistpolicy_dml_regtab_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 10000000 | b    | 10000000 |    1
 20000000 | 20000000 | a    | 20000000 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_int4 SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 10000000 | c    | 10000000 |    1
 20000000 | 20000000 | a    | 20000000 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_int4 WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 20000000 | 20000000 | a    | 20000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_int8;
NOTICE:  table "changedistpolicy_dml_regtab_int8" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_int8
(
    col1 int8,
    col2 int8,
    col3 char,
    col4 int8,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_int8 VALUES(200000000000000000,200000000000000000,'a',200000000000000000,0);
SELECT * FROM changedistpolicy_dml_regtab_int8 ORDER BY 1,2,3,4;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 200000000000000000 | 200000000000000000 | a    | 200000000000000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_int8 SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_int8 SELECT 1000000000000000000, 1000000000000000000,'b', 1000000000000000000, 1;
SELECT * FROM changedistpolicy_dml_regtab_int8 ORDER BY 1,2,3;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
  200000000000000000 |  200000000000000000 | a    |  200000000000000000 |    0
 1000000000000000000 | 1000000000000000000 | b    | 1000000000000000000 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_int8 SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_int8 ORDER BY 1,2,3;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
  200000000000000000 |  200000000000000000 | a    |  200000000000000000 |    0
 1000000000000000000 | 1000000000000000000 | c    | 1000000000000000000 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_int8 WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_int8 ORDER BY 1,2,3;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 200000000000000000 | 200000000000000000 | a    | 200000000000000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_interval;
NOTICE:  table "changedistpolicy_dml_regtab_interval" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_interval
(
    col1 interval,
    col2 interval,
    col3 char,
    col4 interval,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_interval VALUES('10 secs','10 secs','a','10 secs',0);
SELECT * FROM changedistpolicy_dml_regtab_interval ORDER BY 1,2,3,4;
   col1    |   col2    | col3 |   col4    | col5 
-----------+-----------+------+-----------+------
 @ 10 secs | @ 10 secs | a    | @ 10 secs |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_interval SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_interval SELECT '12 hours', '12 hours','b', '12 hours', 1;
SELECT * FROM changedistpolicy_dml_regtab_interval ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 @ 10 secs  | @ 10 secs  | a    | @ 10 secs  |    0
 @ 12 hours | @ 12 hours | b    | @ 12 hours |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_interval SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_interval ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 @ 10 secs  | @ 10 secs  | a    | @ 10 secs  |    0
 @ 12 hours | @ 12 hours | c    | @ 12 hours |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_interval WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_interval ORDER BY 1,2,3;
   col1    |   col2    | col3 |   col4    | col5 
-----------+-----------+------+-----------+------
 @ 10 secs | @ 10 secs | a    | @ 10 secs |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_numeric;
NOTICE:  table "changedistpolicy_dml_regtab_numeric" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_numeric
(
    col1 numeric,
    col2 numeric,
    col3 char,
    col4 numeric,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_numeric VALUES(2.000000,2.000000,'a',2.000000,0);
SELECT * FROM changedistpolicy_dml_regtab_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 2.000000 | 2.000000 | a    | 2.000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_numeric SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_numeric SELECT 1.000000, 1.000000,'b', 1.000000, 1;
SELECT * FROM changedistpolicy_dml_regtab_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 1.000000 | b    | 1.000000 |    1
 2.000000 | 2.000000 | a    | 2.000000 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_numeric SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 1.000000 | c    | 1.000000 |    1
 2.000000 | 2.000000 | a    | 2.000000 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_numeric WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 2.000000 | 2.000000 | a    | 2.000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_char;
NOTICE:  table "changedistpolicy_dml_regtab_random_char" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_char
(
    col1 char,
    col2 char,
    col3 char,
    col4 char,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_char VALUES('g','g','a','g',0);
SELECT * FROM changedistpolicy_dml_regtab_random_char ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | g    |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_char SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_char SELECT 'a', 'a','b', 'a', 1;
SELECT * FROM changedistpolicy_dml_regtab_random_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | a    | b    | a    |    1
 g    | g    | a    | g    |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_char SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | a    | c    | a    |    1
 g    | g    | a    | g    |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_char WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_char ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | g    |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_date;
NOTICE:  table "changedistpolicy_dml_regtab_random_date" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_date
(
    col1 date,
    col2 date,
    col3 char,
    col4 date,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_date VALUES('2013-12-30','2013-12-30','a','2013-12-30',0);
SELECT * FROM changedistpolicy_dml_regtab_random_date ORDER BY 1,2,3,4;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_date SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_date SELECT '2014-01-01', '2014-01-01','b', '2014-01-01', 1;
SELECT * FROM changedistpolicy_dml_regtab_random_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
 01-01-2014 | 01-01-2014 | b    | 01-01-2014 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_date SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
 01-01-2014 | 01-01-2014 | c    | 01-01-2014 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_date WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_date ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 12-30-2013 | 12-30-2013 | a    | 12-30-2013 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_decimal;
NOTICE:  table "changedistpolicy_dml_regtab_random_decimal" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_decimal
(
    col1 decimal,
    col2 decimal,
    col3 char,
    col4 decimal,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_decimal VALUES(2.00,2.00,'a',2.00,0);
SELECT * FROM changedistpolicy_dml_regtab_random_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 2.00 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_decimal SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_decimal SELECT 1.00, 1.00,'b', 1.00, 1;
SELECT * FROM changedistpolicy_dml_regtab_random_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 1.00 | b    | 1.00 |    1
 2.00 | 2.00 | a    | 2.00 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_decimal SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 1.00 | c    | 1.00 |    1
 2.00 | 2.00 | a    | 2.00 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_decimal WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_decimal ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 2.00 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_float;
NOTICE:  table "changedistpolicy_dml_regtab_random_float" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_float
(
    col1 float,
    col2 float,
    col3 char,
    col4 float,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_float VALUES(2.00,2.00,'a',2.00,0);
SELECT * FROM changedistpolicy_dml_regtab_random_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    2 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_float SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_float SELECT 1.00, 1.00,'b', 1.00, 1;
SELECT * FROM changedistpolicy_dml_regtab_random_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    1 | b    |    1 |    1
    2 |    2 | a    |    2 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_float SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    1 | c    |    1 |    1
    2 |    2 | a    |    2 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_float WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_float ORDER BY 1,2,3;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    2 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_int;
NOTICE:  table "changedistpolicy_dml_regtab_random_int" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_int
(
    col1 int,
    col2 int,
    col3 char,
    col4 int,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_int VALUES(10000,10000,'a',10000,0);
SELECT * FROM changedistpolicy_dml_regtab_random_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_int SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_int SELECT 20000, 20000,'b', 20000, 1;
SELECT * FROM changedistpolicy_dml_regtab_random_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
 20000 | 20000 | b    | 20000 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_int SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
 20000 | 20000 | c    | 20000 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_int WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_int ORDER BY 1,2,3;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 10000 | 10000 | a    | 10000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_int4;
NOTICE:  table "changedistpolicy_dml_regtab_random_int4" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_int4
(
    col1 int4,
    col2 int4,
    col3 char,
    col4 int4,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_int4 VALUES(20000000,20000000,'a',20000000,0);
SELECT * FROM changedistpolicy_dml_regtab_random_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 20000000 | 20000000 | a    | 20000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_int4 SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_int4 SELECT 10000000, 10000000,'b', 10000000, 1;
SELECT * FROM changedistpolicy_dml_regtab_random_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 10000000 | b    | 10000000 |    1
 20000000 | 20000000 | a    | 20000000 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_int4 SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 10000000 | c    | 10000000 |    1
 20000000 | 20000000 | a    | 20000000 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_int4 WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_int4 ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 20000000 | 20000000 | a    | 20000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_int8;
NOTICE:  table "changedistpolicy_dml_regtab_random_int8" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_int8
(
    col1 int8,
    col2 int8,
    col3 char,
    col4 int8,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_int8 VALUES(200000000000000000,200000000000000000,'a',200000000000000000,0);
SELECT * FROM changedistpolicy_dml_regtab_random_int8 ORDER BY 1,2,3,4;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 200000000000000000 | 200000000000000000 | a    | 200000000000000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_int8 SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_int8 SELECT 1000000000000000000, 1000000000000000000,'b', 1000000000000000000, 1;
SELECT * FROM changedistpolicy_dml_regtab_random_int8 ORDER BY 1,2,3;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
  200000000000000000 |  200000000000000000 | a    |  200000000000000000 |    0
 1000000000000000000 | 1000000000000000000 | b    | 1000000000000000000 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_int8 SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_int8 ORDER BY 1,2,3;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
  200000000000000000 |  200000000000000000 | a    |  200000000000000000 |    0
 1000000000000000000 | 1000000000000000000 | c    | 1000000000000000000 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_int8 WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_int8 ORDER BY 1,2,3;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 200000000000000000 | 200000000000000000 | a    | 200000000000000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_interval;
NOTICE:  table "changedistpolicy_dml_regtab_random_interval" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_interval
(
    col1 interval,
    col2 interval,
    col3 char,
    col4 interval,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_interval VALUES('10 secs','10 secs','a','10 secs',0);
SELECT * FROM changedistpolicy_dml_regtab_random_interval ORDER BY 1,2,3,4;
   col1    |   col2    | col3 |   col4    | col5 
-----------+-----------+------+-----------+------
 @ 10 secs | @ 10 secs | a    | @ 10 secs |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_interval SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_interval SELECT '11 hours', '11 hours','b', '11 hours', 1;
SELECT * FROM changedistpolicy_dml_regtab_random_interval ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 @ 10 secs  | @ 10 secs  | a    | @ 10 secs  |    0
 @ 11 hours | @ 11 hours | b    | @ 11 hours |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_interval SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_interval ORDER BY 1,2,3;
    col1    |    col2    | col3 |    col4    | col5 
------------+------------+------+------------+------
 @ 10 secs  | @ 10 secs  | a    | @ 10 secs  |    0
 @ 11 hours | @ 11 hours | c    | @ 11 hours |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_interval WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_interval ORDER BY 1,2,3;
   col1    |   col2    | col3 |   col4    | col5 
-----------+-----------+------+-----------+------
 @ 10 secs | @ 10 secs | a    | @ 10 secs |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_numeric;
NOTICE:  table "changedistpolicy_dml_regtab_random_numeric" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_numeric
(
    col1 numeric,
    col2 numeric,
    col3 char,
    col4 numeric,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_numeric VALUES(2.000000,2.000000,'a',2.000000,0);
SELECT * FROM changedistpolicy_dml_regtab_random_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 2.000000 | 2.000000 | a    | 2.000000 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_numeric SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_numeric SELECT 1.000000, 1.000000,'b', 1.000000, 1;
SELECT * FROM changedistpolicy_dml_regtab_random_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 1.000000 | b    | 1.000000 |    1
 2.000000 | 2.000000 | a    | 2.000000 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_numeric SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 1.000000 | c    | 1.000000 |    1
 2.000000 | 2.000000 | a    | 2.000000 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_numeric WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_numeric ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 2.000000 | 2.000000 | a    | 2.000000 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_time;
NOTICE:  table "changedistpolicy_dml_regtab_random_time" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_time
(
    col1 time,
    col2 time,
    col3 char,
    col4 time,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_time VALUES('12:00:00','12:00:00','a','12:00:00',0);
SELECT * FROM changedistpolicy_dml_regtab_random_time ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_time SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_time SELECT '1:00:00', '1:00:00','b', '1:00:00', 1;
SELECT * FROM changedistpolicy_dml_regtab_random_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 01:00:00 | 01:00:00 | b    | 01:00:00 |    1
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_time SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 01:00:00 | 01:00:00 | c    | 01:00:00 |    1
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_time WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_timestamp;
NOTICE:  table "changedistpolicy_dml_regtab_random_timestamp" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_timestamp
(
    col1 timestamp,
    col2 timestamp,
    col3 char,
    col4 timestamp,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_timestamp VALUES('2013-12-30 12:00:00','2013-12-30 12:00:00','a','2013-12-30 12:00:00',0);
SELECT * FROM changedistpolicy_dml_regtab_random_timestamp ORDER BY 1,2,3,4;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_timestamp SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_timestamp SELECT '2014-01-01 12:00:00', '2014-01-01 12:00:00','b', '2014-01-01 12:00:00', 1;
SELECT * FROM changedistpolicy_dml_regtab_random_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
 Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014 | b    | Wed Jan 01 12:00:00 2014 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_timestamp SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
 Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014 | c    | Wed Jan 01 12:00:00 2014 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_timestamp WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_random_timestamptz;
NOTICE:  table "changedistpolicy_dml_regtab_random_timestamptz" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_random_timestamptz
(
    col1 timestamptz,
    col2 timestamptz,
    col3 char,
    col4 timestamptz,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_random_timestamptz VALUES('2013-12-30 12:00:00 PST','2013-12-30 12:00:00 PST','a','2013-12-30 12:00:00 PST',0);
SELECT * FROM changedistpolicy_dml_regtab_random_timestamptz ORDER BY 1,2,3,4;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_random_timestamptz SET DISTRIBUTED randomly;
INSERT INTO changedistpolicy_dml_regtab_random_timestamptz SELECT '2014-01-01 12:00:00 PST', '2014-01-01 12:00:00 PST','b', '2014-01-01 12:00:00 PST', 1;
SELECT * FROM changedistpolicy_dml_regtab_random_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
 Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST | b    | Wed Jan 01 12:00:00 2014 PST |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_random_timestamptz SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_random_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
 Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST | c    | Wed Jan 01 12:00:00 2014 PST |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_random_timestamptz WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_random_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_time;
NOTICE:  table "changedistpolicy_dml_regtab_time" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_time
(
    col1 time,
    col2 time,
    col3 char,
    col4 time,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_time VALUES('12:00:00','12:00:00','a','12:00:00',0);
SELECT * FROM changedistpolicy_dml_regtab_time ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_time SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_time SELECT '1:00:00', '1:00:00','b', '1:00:00', 1;
SELECT * FROM changedistpolicy_dml_regtab_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 01:00:00 | 01:00:00 | b    | 01:00:00 |    1
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_time SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 01:00:00 | 01:00:00 | c    | 01:00:00 |    1
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_time WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_time ORDER BY 1,2,3;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 12:00:00 | 12:00:00 | a    | 12:00:00 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_timestamp;
NOTICE:  table "changedistpolicy_dml_regtab_timestamp" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_timestamp
(
    col1 timestamp,
    col2 timestamp,
    col3 char,
    col4 timestamp,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_timestamp VALUES('2013-12-30 12:00:00','2013-12-30 12:00:00','a','2013-12-30 12:00:00',0);
SELECT * FROM changedistpolicy_dml_regtab_timestamp ORDER BY 1,2,3,4;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_timestamp SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_timestamp SELECT '2014-01-01 12:00:00', '2014-01-01 12:00:00','b', '2014-01-01 12:00:00', 1;
SELECT * FROM changedistpolicy_dml_regtab_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
 Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014 | b    | Wed Jan 01 12:00:00 2014 |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_timestamp SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
 Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014 | c    | Wed Jan 01 12:00:00 2014 |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_timestamp WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_timestamp ORDER BY 1,2,3;
           col1           |           col2           | col3 |           col4           | col5 
--------------------------+--------------------------+------+--------------------------+------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Mon Dec 30 12:00:00 2013 |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS changedistpolicy_dml_regtab_timestamptz;
NOTICE:  table "changedistpolicy_dml_regtab_timestamptz" does not exist, skipping
CREATE TABLE changedistpolicy_dml_regtab_timestamptz
(
    col1 timestamptz,
    col2 timestamptz,
    col3 char,
    col4 timestamptz,
    col5 int
) DISTRIBUTED by (col1);
INSERT INTO changedistpolicy_dml_regtab_timestamptz VALUES('2013-12-30 12:00:00 PST','2013-12-30 12:00:00 PST','a','2013-12-30 12:00:00 PST',0);
SELECT * FROM changedistpolicy_dml_regtab_timestamptz ORDER BY 1,2,3,4;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
(1 row)

ALTER TABLE changedistpolicy_dml_regtab_timestamptz SET DISTRIBUTED BY (col3);
INSERT INTO changedistpolicy_dml_regtab_timestamptz SELECT '2014-01-01 12:00:00 PST', '2014-01-01 12:00:00 PST','b', '2014-01-01 12:00:00 PST', 1;
SELECT * FROM changedistpolicy_dml_regtab_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
 Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST | b    | Wed Jan 01 12:00:00 2014 PST |    1
(2 rows)

-- Update distribution key
UPDATE changedistpolicy_dml_regtab_timestamptz SET col3 ='c' WHERE col3 ='b' AND col5 = 1;
SELECT * FROM changedistpolicy_dml_regtab_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
 Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST | c    | Wed Jan 01 12:00:00 2014 PST |    1
(2 rows)

DELETE FROM changedistpolicy_dml_regtab_timestamptz WHERE col3 ='c';
SELECT * FROM changedistpolicy_dml_regtab_timestamptz ORDER BY 1,2,3;
             col1             |             col2             | col3 |             col4             | col5 
------------------------------+------------------------------+------+------------------------------+------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Mon Dec 30 12:00:00 2013 PST |    0
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_char;
NOTICE:  table "colalias_dml_char" does not exist, skipping
CREATE TABLE colalias_dml_char
(
    col1 char DEFAULT 'a',
    col2 char,
    col3 char,
    col4 char,
    col5 char
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_char_1_prt_def" for table "colalias_dml_char"
DROP TABLE IF EXISTS colalias_dml_char_candidate;
NOTICE:  table "colalias_dml_char_candidate" does not exist, skipping
CREATE TABLE colalias_dml_char_candidate
(
    col1 char DEFAULT 'a',
    col2 char,
    col3 char,
    col4 char,
    col5 char
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_char_candidate VALUES('g','a','a','g','a');
INSERT INTO colalias_dml_char(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_char_candidate)foo;
SELECT * FROM colalias_dml_char ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 g    | g    | a    | a    | a
(1 row)

UPDATE colalias_dml_char SET col1 = (select col2 as col1 FROM colalias_dml_char_candidate);
SELECT * FROM colalias_dml_char ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | g    | a    | a    | a
(1 row)

UPDATE colalias_dml_char SET col1 =colalias_dml_char_candidate.col2 FROM colalias_dml_char_candidate;
SELECT * FROM colalias_dml_char ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 a    | g    | a    | a    | a
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_date;
NOTICE:  table "colalias_dml_date" does not exist, skipping
CREATE TABLE colalias_dml_date
(
    col1 date DEFAULT '2014-01-01',
    col2 date,
    col3 char,
    col4 date,
    col5 date
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_date_1_prt_def" for table "colalias_dml_date"
DROP TABLE IF EXISTS colalias_dml_date_candidate;
NOTICE:  table "colalias_dml_date_candidate" does not exist, skipping
CREATE TABLE colalias_dml_date_candidate
(
    col1 date DEFAULT '2014-01-01',
    col2 date,
    col3 char,
    col4 date,
    col5 date
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_date_candidate VALUES('2013-12-30','2014-01-01','a','2013-12-30','2014-01-01');
INSERT INTO colalias_dml_date(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_date_candidate)foo;
SELECT * FROM colalias_dml_date ORDER BY 1,2,3,4;
    col1    |    col2    | col3 |    col4    |    col5    
------------+------------+------+------------+------------
 12-30-2013 | 12-30-2013 | a    | 01-01-2014 | 01-01-2014
(1 row)

UPDATE colalias_dml_date SET col1 = (select col2 as col1 FROM colalias_dml_date_candidate);
SELECT * FROM colalias_dml_date ORDER BY 1,2,3,4;
    col1    |    col2    | col3 |    col4    |    col5    
------------+------------+------+------------+------------
 01-01-2014 | 12-30-2013 | a    | 01-01-2014 | 01-01-2014
(1 row)

UPDATE colalias_dml_date SET col1 =colalias_dml_date_candidate.col2 FROM colalias_dml_date_candidate;
SELECT * FROM colalias_dml_date ORDER BY 1,2,3,4;
    col1    |    col2    | col3 |    col4    |    col5    
------------+------------+------+------------+------------
 01-01-2014 | 12-30-2013 | a    | 01-01-2014 | 01-01-2014
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_decimal;
NOTICE:  table "colalias_dml_decimal" does not exist, skipping
CREATE TABLE colalias_dml_decimal
(
    col1 decimal DEFAULT 1.00,
    col2 decimal,
    col3 char,
    col4 decimal,
    col5 decimal
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_decimal_1_prt_def" for table "colalias_dml_decimal"
DROP TABLE IF EXISTS colalias_dml_decimal_candidate;
NOTICE:  table "colalias_dml_decimal_candidate" does not exist, skipping
CREATE TABLE colalias_dml_decimal_candidate
(
    col1 decimal DEFAULT 1.00,
    col2 decimal,
    col3 char,
    col4 decimal,
    col5 decimal
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_decimal_candidate VALUES(2.00,1.00,'a',2.00,1.00);
INSERT INTO colalias_dml_decimal(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_decimal_candidate)foo;
SELECT * FROM colalias_dml_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 2.00 | 2.00 | a    | 1.00 | 1.00
(1 row)

UPDATE colalias_dml_decimal SET col1 = (select col2 as col1 FROM colalias_dml_decimal_candidate);
SELECT * FROM colalias_dml_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 2.00 | a    | 1.00 | 1.00
(1 row)

UPDATE colalias_dml_decimal SET col1 =colalias_dml_decimal_candidate.col2 FROM colalias_dml_decimal_candidate;
SELECT * FROM colalias_dml_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 2.00 | a    | 1.00 | 1.00
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_float;
NOTICE:  table "colalias_dml_float" does not exist, skipping
CREATE TABLE colalias_dml_float
(
    col1 float DEFAULT 1.00,
    col2 float,
    col3 char,
    col4 float,
    col5 float
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_float_1_prt_def" for table "colalias_dml_float"
DROP TABLE IF EXISTS colalias_dml_float_candidate;
NOTICE:  table "colalias_dml_float_candidate" does not exist, skipping
CREATE TABLE colalias_dml_float_candidate
(
    col1 float DEFAULT 1.00,
    col2 float,
    col3 char,
    col4 float,
    col5 float
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_float_candidate VALUES(2.00,1.00,'a',2.00,1.00);
INSERT INTO colalias_dml_float(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_float_candidate)foo;
SELECT * FROM colalias_dml_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    2 |    2 | a    |    1 |    1
(1 row)

UPDATE colalias_dml_float SET col1 = (select col2 as col1 FROM colalias_dml_float_candidate);
SELECT * FROM colalias_dml_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    2 | a    |    1 |    1
(1 row)

UPDATE colalias_dml_float SET col1 =colalias_dml_float_candidate.col2 FROM colalias_dml_float_candidate;
SELECT * FROM colalias_dml_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    2 | a    |    1 |    1
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_int;
NOTICE:  table "colalias_dml_int" does not exist, skipping
CREATE TABLE colalias_dml_int
(
    col1 int DEFAULT 20000,
    col2 int,
    col3 char,
    col4 int,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_int_1_prt_def" for table "colalias_dml_int"
DROP TABLE IF EXISTS colalias_dml_int_candidate;
NOTICE:  table "colalias_dml_int_candidate" does not exist, skipping
CREATE TABLE colalias_dml_int_candidate
(
    col1 int DEFAULT 20000,
    col2 int,
    col3 char,
    col4 int,
    col5 int
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_int_candidate VALUES(10000,20000,'a',10000,20000);
INSERT INTO colalias_dml_int(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_int_candidate)foo;
SELECT * FROM colalias_dml_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5  
-------+-------+------+-------+-------
 10000 | 10000 | a    | 20000 | 20000
(1 row)

UPDATE colalias_dml_int SET col1 = (select col2 as col1 FROM colalias_dml_int_candidate);
SELECT * FROM colalias_dml_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5  
-------+-------+------+-------+-------
 20000 | 10000 | a    | 20000 | 20000
(1 row)

UPDATE colalias_dml_int SET col1 =colalias_dml_int_candidate.col2 FROM colalias_dml_int_candidate;
SELECT * FROM colalias_dml_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5  
-------+-------+------+-------+-------
 20000 | 10000 | a    | 20000 | 20000
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_int4;
NOTICE:  table "colalias_dml_int4" does not exist, skipping
CREATE TABLE colalias_dml_int4
(
    col1 int4 DEFAULT 10000000,
    col2 int4,
    col3 char,
    col4 int4,
    col5 int4
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_int4_1_prt_def" for table "colalias_dml_int4"
DROP TABLE IF EXISTS colalias_dml_int4_candidate;
NOTICE:  table "colalias_dml_int4_candidate" does not exist, skipping
CREATE TABLE colalias_dml_int4_candidate
(
    col1 int4 DEFAULT 10000000,
    col2 int4,
    col3 char,
    col4 int4,
    col5 int4
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_int4_candidate VALUES(20000000,10000000,'a',20000000,10000000);
INSERT INTO colalias_dml_int4(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_int4_candidate)foo;
SELECT * FROM colalias_dml_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 20000000 | 20000000 | a    | 10000000 | 10000000
(1 row)

UPDATE colalias_dml_int4 SET col1 = (select col2 as col1 FROM colalias_dml_int4_candidate);
SELECT * FROM colalias_dml_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 10000000 | 20000000 | a    | 10000000 | 10000000
(1 row)

UPDATE colalias_dml_int4 SET col1 =colalias_dml_int4_candidate.col2 FROM colalias_dml_int4_candidate;
SELECT * FROM colalias_dml_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 10000000 | 20000000 | a    | 10000000 | 10000000
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_int8;
NOTICE:  table "colalias_dml_int8" does not exist, skipping
CREATE TABLE colalias_dml_int8
(
    col1 int8 DEFAULT 1000000000000000000,
    col2 int8,
    col3 char,
    col4 int8,
    col5 int8
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_int8_1_prt_def" for table "colalias_dml_int8"
DROP TABLE IF EXISTS colalias_dml_int8_candidate;
NOTICE:  table "colalias_dml_int8_candidate" does not exist, skipping
CREATE TABLE colalias_dml_int8_candidate
(
    col1 int8 DEFAULT 1000000000000000000,
    col2 int8,
    col3 char,
    col4 int8,
    col5 int8
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_int8_candidate VALUES(200000000000000000,1000000000000000000,'a',200000000000000000,1000000000000000000);
INSERT INTO colalias_dml_int8(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_int8_candidate)foo;
SELECT * FROM colalias_dml_int8 ORDER BY 1,2,3,4;
        col1        |        col2        | col3 |        col4         |        col5         
--------------------+--------------------+------+---------------------+---------------------
 200000000000000000 | 200000000000000000 | a    | 1000000000000000000 | 1000000000000000000
(1 row)

UPDATE colalias_dml_int8 SET col1 = (select col2 as col1 FROM colalias_dml_int8_candidate);
SELECT * FROM colalias_dml_int8 ORDER BY 1,2,3,4;
        col1         |        col2        | col3 |        col4         |        col5         
---------------------+--------------------+------+---------------------+---------------------
 1000000000000000000 | 200000000000000000 | a    | 1000000000000000000 | 1000000000000000000
(1 row)

UPDATE colalias_dml_int8 SET col1 =colalias_dml_int8_candidate.col2 FROM colalias_dml_int8_candidate;
SELECT * FROM colalias_dml_int8 ORDER BY 1,2,3,4;
        col1         |        col2        | col3 |        col4         |        col5         
---------------------+--------------------+------+---------------------+---------------------
 1000000000000000000 | 200000000000000000 | a    | 1000000000000000000 | 1000000000000000000
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_interval;
NOTICE:  table "colalias_dml_interval" does not exist, skipping
CREATE TABLE colalias_dml_interval
(
    col1 interval DEFAULT '11 hours',
    col2 interval,
    col3 char,
    col4 interval,
    col5 interval
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_interval_1_prt_def" for table "colalias_dml_interval"
DROP TABLE IF EXISTS colalias_dml_interval_candidate;
NOTICE:  table "colalias_dml_interval_candidate" does not exist, skipping
CREATE TABLE colalias_dml_interval_candidate
(
    col1 interval DEFAULT '11 hours',
    col2 interval,
    col3 char,
    col4 interval,
    col5 interval
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_interval_candidate VALUES('10 secs','11 hours','a','10 secs','11 hours');
INSERT INTO colalias_dml_interval(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_interval_candidate)foo;
SELECT * FROM colalias_dml_interval ORDER BY 1,2,3,4;
   col1    |   col2    | col3 |    col4    |    col5    
-----------+-----------+------+------------+------------
 @ 10 secs | @ 10 secs | a    | @ 11 hours | @ 11 hours
(1 row)

UPDATE colalias_dml_interval SET col1 = (select col2 as col1 FROM colalias_dml_interval_candidate);
SELECT * FROM colalias_dml_interval ORDER BY 1,2,3,4;
    col1    |   col2    | col3 |    col4    |    col5    
------------+-----------+------+------------+------------
 @ 11 hours | @ 10 secs | a    | @ 11 hours | @ 11 hours
(1 row)

UPDATE colalias_dml_interval SET col1 =colalias_dml_interval_candidate.col2 FROM colalias_dml_interval_candidate;
SELECT * FROM colalias_dml_interval ORDER BY 1,2,3,4;
    col1    |   col2    | col3 |    col4    |    col5    
------------+-----------+------+------------+------------
 @ 11 hours | @ 10 secs | a    | @ 11 hours | @ 11 hours
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_numeric;
NOTICE:  table "colalias_dml_numeric" does not exist, skipping
CREATE TABLE colalias_dml_numeric
(
    col1 numeric DEFAULT 1.000000,
    col2 numeric,
    col3 char,
    col4 numeric,
    col5 numeric
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_numeric_1_prt_def" for table "colalias_dml_numeric"
DROP TABLE IF EXISTS colalias_dml_numeric_candidate;
NOTICE:  table "colalias_dml_numeric_candidate" does not exist, skipping
CREATE TABLE colalias_dml_numeric_candidate
(
    col1 numeric DEFAULT 1.000000,
    col2 numeric,
    col3 char,
    col4 numeric,
    col5 numeric
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_numeric_candidate VALUES(2.000000,1.000000,'a',2.000000,1.000000);
INSERT INTO colalias_dml_numeric(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_numeric_candidate)foo;
SELECT * FROM colalias_dml_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 2.000000 | 2.000000 | a    | 1.000000 | 1.000000
(1 row)

UPDATE colalias_dml_numeric SET col1 = (select col2 as col1 FROM colalias_dml_numeric_candidate);
SELECT * FROM colalias_dml_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 1.000000 | 2.000000 | a    | 1.000000 | 1.000000
(1 row)

UPDATE colalias_dml_numeric SET col1 =colalias_dml_numeric_candidate.col2 FROM colalias_dml_numeric_candidate;
SELECT * FROM colalias_dml_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 1.000000 | 2.000000 | a    | 1.000000 | 1.000000
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_time;
NOTICE:  table "colalias_dml_time" does not exist, skipping
CREATE TABLE colalias_dml_time
(
    col1 time DEFAULT '1:00:00',
    col2 time,
    col3 char,
    col4 time,
    col5 time
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_time_1_prt_def" for table "colalias_dml_time"
DROP TABLE IF EXISTS colalias_dml_time_candidate;
NOTICE:  table "colalias_dml_time_candidate" does not exist, skipping
CREATE TABLE colalias_dml_time_candidate
(
    col1 time DEFAULT '1:00:00',
    col2 time,
    col3 char,
    col4 time,
    col5 time
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_time_candidate VALUES('12:00:00','1:00:00','a','12:00:00','1:00:00');
INSERT INTO colalias_dml_time(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_time_candidate)foo;
SELECT * FROM colalias_dml_time ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 12:00:00 | 12:00:00 | a    | 01:00:00 | 01:00:00
(1 row)

UPDATE colalias_dml_time SET col1 = (select col2 as col1 FROM colalias_dml_time_candidate);
SELECT * FROM colalias_dml_time ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 01:00:00 | 12:00:00 | a    | 01:00:00 | 01:00:00
(1 row)

UPDATE colalias_dml_time SET col1 =colalias_dml_time_candidate.col2 FROM colalias_dml_time_candidate;
SELECT * FROM colalias_dml_time ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   |   col5   
----------+----------+------+----------+----------
 01:00:00 | 12:00:00 | a    | 01:00:00 | 01:00:00
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_timestamp;
NOTICE:  table "colalias_dml_timestamp" does not exist, skipping
CREATE TABLE colalias_dml_timestamp
(
    col1 timestamp DEFAULT '2014-01-01 12:00:00',
    col2 timestamp,
    col3 char,
    col4 timestamp,
    col5 timestamp
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_timestamp_1_prt_def" for table "colalias_dml_timestamp"
DROP TABLE IF EXISTS colalias_dml_timestamp_candidate;
NOTICE:  table "colalias_dml_timestamp_candidate" does not exist, skipping
CREATE TABLE colalias_dml_timestamp_candidate
(
    col1 timestamp DEFAULT '2014-01-01 12:00:00',
    col2 timestamp,
    col3 char,
    col4 timestamp,
    col5 timestamp
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_timestamp_candidate VALUES('2013-12-30 12:00:00','2014-01-01 12:00:00','a','2013-12-30 12:00:00','2014-01-01 12:00:00');
INSERT INTO colalias_dml_timestamp(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_timestamp_candidate)foo;
SELECT * FROM colalias_dml_timestamp ORDER BY 1,2,3,4;
           col1           |           col2           | col3 |           col4           |           col5           
--------------------------+--------------------------+------+--------------------------+--------------------------
 Mon Dec 30 12:00:00 2013 | Mon Dec 30 12:00:00 2013 | a    | Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014
(1 row)

UPDATE colalias_dml_timestamp SET col1 = (select col2 as col1 FROM colalias_dml_timestamp_candidate);
SELECT * FROM colalias_dml_timestamp ORDER BY 1,2,3,4;
           col1           |           col2           | col3 |           col4           |           col5           
--------------------------+--------------------------+------+--------------------------+--------------------------
 Wed Jan 01 12:00:00 2014 | Mon Dec 30 12:00:00 2013 | a    | Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014
(1 row)

UPDATE colalias_dml_timestamp SET col1 =colalias_dml_timestamp_candidate.col2 FROM colalias_dml_timestamp_candidate;
SELECT * FROM colalias_dml_timestamp ORDER BY 1,2,3,4;
           col1           |           col2           | col3 |           col4           |           col5           
--------------------------+--------------------------+------+--------------------------+--------------------------
 Wed Jan 01 12:00:00 2014 | Mon Dec 30 12:00:00 2013 | a    | Wed Jan 01 12:00:00 2014 | Wed Jan 01 12:00:00 2014
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS colalias_dml_timestamptz;
NOTICE:  table "colalias_dml_timestamptz" does not exist, skipping
CREATE TABLE colalias_dml_timestamptz
(
    col1 timestamptz DEFAULT '2014-01-01 12:00:00 PST',
    col2 timestamptz,
    col3 char,
    col4 timestamptz,
    col5 timestamptz
) 
DISTRIBUTED by (col1)
PARTITION BY LIST(col2)
(
default partition def 
);
NOTICE:  CREATE TABLE will create partition "colalias_dml_timestamptz_1_prt_def" for table "colalias_dml_timestamptz"
DROP TABLE IF EXISTS colalias_dml_timestamptz_candidate;
NOTICE:  table "colalias_dml_timestamptz_candidate" does not exist, skipping
CREATE TABLE colalias_dml_timestamptz_candidate
(
    col1 timestamptz DEFAULT '2014-01-01 12:00:00 PST',
    col2 timestamptz,
    col3 char,
    col4 timestamptz,
    col5 timestamptz
) DISTRIBUTED by (col2);
INSERT INTO colalias_dml_timestamptz_candidate VALUES('2013-12-30 12:00:00 PST','2014-01-01 12:00:00 PST','a','2013-12-30 12:00:00 PST','2014-01-01 12:00:00 PST');
INSERT INTO colalias_dml_timestamptz(col2,col1,col3,col5,col4) SELECT col1,col2,col3,col5,col4 FROM (SELECT col1,col1 as col2,col3,col5 as col4,col5  FROM colalias_dml_timestamptz_candidate)foo;
SELECT * FROM colalias_dml_timestamptz ORDER BY 1,2,3,4;
             col1             |             col2             | col3 |             col4             |             col5             
------------------------------+------------------------------+------+------------------------------+------------------------------
 Mon Dec 30 12:00:00 2013 PST | Mon Dec 30 12:00:00 2013 PST | a    | Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST
(1 row)

UPDATE colalias_dml_timestamptz SET col1 = (select col2 as col1 FROM colalias_dml_timestamptz_candidate);
SELECT * FROM colalias_dml_timestamptz ORDER BY 1,2,3,4;
             col1             |             col2             | col3 |             col4             |             col5             
------------------------------+------------------------------+------+------------------------------+------------------------------
 Wed Jan 01 12:00:00 2014 PST | Mon Dec 30 12:00:00 2013 PST | a    | Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST
(1 row)

UPDATE colalias_dml_timestamptz SET col1 =colalias_dml_timestamptz_candidate.col2 FROM colalias_dml_timestamptz_candidate;
SELECT * FROM colalias_dml_timestamptz ORDER BY 1,2,3,4;
             col1             |             col2             | col3 |             col4             |             col5             
------------------------------+------------------------------+------+------------------------------+------------------------------
 Wed Jan 01 12:00:00 2014 PST | Mon Dec 30 12:00:00 2013 PST | a    | Wed Jan 01 12:00:00 2014 PST | Wed Jan 01 12:00:00 2014 PST
(1 row)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_decimal;
NOTICE:  table "computedcol_dml_decimal" does not exist, skipping
CREATE TABLE computedcol_dml_decimal
(
    col1 decimal DEFAULT 1.00,
    col2 decimal,
    col3 char,
    col4 decimal,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start(1.00) end(10.00)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10.00) end(20.00) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20.00) end(30.00), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_decimal_1_prt_def" for table "computedcol_dml_decimal"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_decimal_1_prt_partone" for table "computedcol_dml_decimal"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_decimal_1_prt_parttwo" for table "computedcol_dml_decimal"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_decimal_1_prt_partthree" for table "computedcol_dml_decimal"
INSERT INTO computedcol_dml_decimal(col2,col1,col3,col5,col4) SELECT 2.00::decimal+1.00::decimal, 2.00::decimal+1.00::decimal, 'a', 1,2.00::decimal+1.00::decimal;
INSERT INTO computedcol_dml_decimal(col2,col3,col5,col4) SELECT 2.00::decimal+1.00::decimal,'a', 1,2.00::decimal+1.00::decimal; 
SELECT * FROM computedcol_dml_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 1.00 | 3.00 | a    | 3.00 |    1
 3.00 | 3.00 | a    | 3.00 |    1
(2 rows)

UPDATE computedcol_dml_decimal SET col1=2.00::decimal+1.00::decimal;
SELECT * FROM computedcol_dml_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
 3.00 | 3.00 | a    | 3.00 |    1
 3.00 | 3.00 | a    | 3.00 |    1
(2 rows)

DELETE FROM computedcol_dml_decimal WHERE col1=1.00::decimal + 2.00::decimal;
SELECT * FROM computedcol_dml_decimal ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_float;
NOTICE:  table "computedcol_dml_float" does not exist, skipping
CREATE TABLE computedcol_dml_float
(
    col1 float DEFAULT 1.00,
    col2 float,
    col3 char,
    col4 float,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start(1.00) end(10.00)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10.00) end(20.00) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20.00) end(30.00), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_float_1_prt_def" for table "computedcol_dml_float"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_float_1_prt_partone" for table "computedcol_dml_float"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_float_1_prt_parttwo" for table "computedcol_dml_float"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_float_1_prt_partthree" for table "computedcol_dml_float"
INSERT INTO computedcol_dml_float(col2,col1,col3,col5,col4) SELECT 2.00::float+1.00::float, 2.00::float+1.00::float, 'a', 1,2.00::float+1.00::float;
INSERT INTO computedcol_dml_float(col2,col3,col5,col4) SELECT 2.00::float+1.00::float,'a', 1,2.00::float+1.00::float; 
SELECT * FROM computedcol_dml_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    1 |    3 | a    |    3 |    1
    3 |    3 | a    |    3 |    1
(2 rows)

UPDATE computedcol_dml_float SET col1=2.00::float+1.00::float;
SELECT * FROM computedcol_dml_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
    3 |    3 | a    |    3 |    1
    3 |    3 | a    |    3 |    1
(2 rows)

DELETE FROM computedcol_dml_float WHERE col1=1.00::float + 2.00::float;
SELECT * FROM computedcol_dml_float ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_int;
NOTICE:  table "computedcol_dml_int" does not exist, skipping
CREATE TABLE computedcol_dml_int
(
    col1 int DEFAULT 20000,
    col2 int,
    col3 char,
    col4 int,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start(1) end(10001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10001) end(20001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20001) end(30001), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int_1_prt_def" for table "computedcol_dml_int"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int_1_prt_partone" for table "computedcol_dml_int"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int_1_prt_parttwo" for table "computedcol_dml_int"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int_1_prt_partthree" for table "computedcol_dml_int"
INSERT INTO computedcol_dml_int(col2,col1,col3,col5,col4) SELECT 10000::int+20000::int, 10000::int+20000::int, 'a', 1,10000::int+20000::int;
INSERT INTO computedcol_dml_int(col2,col3,col5,col4) SELECT 10000::int+20000::int,'a', 1,10000::int+20000::int; 
SELECT * FROM computedcol_dml_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 20000 | 30000 | a    | 30000 |    1
 30000 | 30000 | a    | 30000 |    1
(2 rows)

UPDATE computedcol_dml_int SET col1=10000::int+20000::int;
SELECT * FROM computedcol_dml_int ORDER BY 1,2,3,4;
 col1  | col2  | col3 | col4  | col5 
-------+-------+------+-------+------
 30000 | 30000 | a    | 30000 |    1
 30000 | 30000 | a    | 30000 |    1
(2 rows)

DELETE FROM computedcol_dml_int WHERE col1=20000::int + 10000::int;
SELECT * FROM computedcol_dml_int ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_int4;
NOTICE:  table "computedcol_dml_int4" does not exist, skipping
CREATE TABLE computedcol_dml_int4
(
    col1 int4 DEFAULT 10000000,
    col2 int4,
    col3 char,
    col4 int4,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start(1) end(100000001)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(100000001) end(200000001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(200000001) end(300000001), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int4_1_prt_def" for table "computedcol_dml_int4"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int4_1_prt_partone" for table "computedcol_dml_int4"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int4_1_prt_parttwo" for table "computedcol_dml_int4"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int4_1_prt_partthree" for table "computedcol_dml_int4"
INSERT INTO computedcol_dml_int4(col2,col1,col3,col5,col4) SELECT 20000000::int4+10000000::int4, 20000000::int4+10000000::int4, 'a', 1,20000000::int4+10000000::int4;
INSERT INTO computedcol_dml_int4(col2,col3,col5,col4) SELECT 20000000::int4+10000000::int4,'a', 1,20000000::int4+10000000::int4; 
SELECT * FROM computedcol_dml_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 10000000 | 30000000 | a    | 30000000 |    1
 30000000 | 30000000 | a    | 30000000 |    1
(2 rows)

UPDATE computedcol_dml_int4 SET col1=20000000::int4+10000000::int4;
SELECT * FROM computedcol_dml_int4 ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 30000000 | 30000000 | a    | 30000000 |    1
 30000000 | 30000000 | a    | 30000000 |    1
(2 rows)

DELETE FROM computedcol_dml_int4 WHERE col1=10000000::int4 + 20000000::int4;
SELECT * FROM computedcol_dml_int4 ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_int8;
NOTICE:  table "computedcol_dml_int8" does not exist, skipping
CREATE TABLE computedcol_dml_int8
(
    col1 int8 DEFAULT 1000000000000000000,
    col2 int8,
    col3 char,
    col4 int8,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start(1) end(1000000000000000001)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(1000000000000000001) end(2000000000000000001) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(2000000000000000001) end(3000000000000000001), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int8_1_prt_def" for table "computedcol_dml_int8"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int8_1_prt_partone" for table "computedcol_dml_int8"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int8_1_prt_parttwo" for table "computedcol_dml_int8"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_int8_1_prt_partthree" for table "computedcol_dml_int8"
INSERT INTO computedcol_dml_int8(col2,col1,col3,col5,col4) SELECT 200000000000000000::int8+1000000000000000000::int8, 200000000000000000::int8+1000000000000000000::int8, 'a', 1,200000000000000000::int8+1000000000000000000::int8;
INSERT INTO computedcol_dml_int8(col2,col3,col5,col4) SELECT 200000000000000000::int8+1000000000000000000::int8,'a', 1,200000000000000000::int8+1000000000000000000::int8; 
SELECT * FROM computedcol_dml_int8 ORDER BY 1,2,3,4;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
 1000000000000000000 | 1200000000000000000 | a    | 1200000000000000000 |    1
 1200000000000000000 | 1200000000000000000 | a    | 1200000000000000000 |    1
(2 rows)

UPDATE computedcol_dml_int8 SET col1=200000000000000000::int8+1000000000000000000::int8;
SELECT * FROM computedcol_dml_int8 ORDER BY 1,2,3,4;
        col1         |        col2         | col3 |        col4         | col5 
---------------------+---------------------+------+---------------------+------
 1200000000000000000 | 1200000000000000000 | a    | 1200000000000000000 |    1
 1200000000000000000 | 1200000000000000000 | a    | 1200000000000000000 |    1
(2 rows)

DELETE FROM computedcol_dml_int8 WHERE col1=1000000000000000000::int8 + 200000000000000000::int8;
SELECT * FROM computedcol_dml_int8 ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_interval;
NOTICE:  table "computedcol_dml_interval" does not exist, skipping
CREATE TABLE computedcol_dml_interval
(
    col1 interval DEFAULT '11 hours',
    col2 interval,
    col3 char,
    col4 interval,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start('1 sec') end('1 min')  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start('1 min') end('1 hour') WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start('1 hour') end('12 hours'), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_interval_1_prt_def" for table "computedcol_dml_interval"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_interval_1_prt_partone" for table "computedcol_dml_interval"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_interval_1_prt_parttwo" for table "computedcol_dml_interval"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_interval_1_prt_partthree" for table "computedcol_dml_interval"
INSERT INTO computedcol_dml_interval(col2,col1,col3,col5,col4) SELECT '10 secs'::interval+'11 hours'::interval, '10 secs'::interval+'11 hours'::interval, 'a', 1,'10 secs'::interval+'11 hours'::interval;
INSERT INTO computedcol_dml_interval(col2,col3,col5,col4) SELECT '10 secs'::interval+'11 hours'::interval,'a', 1,'10 secs'::interval+'11 hours'::interval; 
SELECT * FROM computedcol_dml_interval ORDER BY 1,2,3,4;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 @ 11 hours         | @ 11 hours 10 secs | a    | @ 11 hours 10 secs |    1
 @ 11 hours 10 secs | @ 11 hours 10 secs | a    | @ 11 hours 10 secs |    1
(2 rows)

UPDATE computedcol_dml_interval SET col1='10 secs'::interval+'11 hours'::interval;
SELECT * FROM computedcol_dml_interval ORDER BY 1,2,3,4;
        col1        |        col2        | col3 |        col4        | col5 
--------------------+--------------------+------+--------------------+------
 @ 11 hours 10 secs | @ 11 hours 10 secs | a    | @ 11 hours 10 secs |    1
 @ 11 hours 10 secs | @ 11 hours 10 secs | a    | @ 11 hours 10 secs |    1
(2 rows)

DELETE FROM computedcol_dml_interval WHERE col1='11 hours'::interval + '10 secs'::interval;
SELECT * FROM computedcol_dml_interval ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd 
-- @created 2014-04-01 12:00:00
-- @modified 2012-04-01 12:00:00
-- @tags dml MPP-21090 ORCA
-- @product_version gpdb: [4.3-]
-- @optimizer_mode on	
-- @description Tests for MPP-21090
DROP TABLE IF EXISTS computedcol_dml_numeric;
NOTICE:  table "computedcol_dml_numeric" does not exist, skipping
CREATE TABLE computedcol_dml_numeric
(
    col1 numeric DEFAULT 1.000000,
    col2 numeric,
    col3 char,
    col4 numeric,
    col5 int
) 
DISTRIBUTED by (col1)
PARTITION BY RANGE(col2)(partition partone start(1.000000) end(10.000000)  WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=column),partition parttwo start(10.000000) end(20.000000) WITH (APPENDONLY=true, COMPRESSLEVEL=5, ORIENTATION=row),partition partthree start(20.000000) end(30.000000), default partition def);
NOTICE:  CREATE TABLE will create partition "computedcol_dml_numeric_1_prt_def" for table "computedcol_dml_numeric"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_numeric_1_prt_partone" for table "computedcol_dml_numeric"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_numeric_1_prt_parttwo" for table "computedcol_dml_numeric"
NOTICE:  CREATE TABLE will create partition "computedcol_dml_numeric_1_prt_partthree" for table "computedcol_dml_numeric"
INSERT INTO computedcol_dml_numeric(col2,col1,col3,col5,col4) SELECT 2.000000::numeric+1.000000::numeric, 2.000000::numeric+1.000000::numeric, 'a', 1,2.000000::numeric+1.000000::numeric;
INSERT INTO computedcol_dml_numeric(col2,col3,col5,col4) SELECT 2.000000::numeric+1.000000::numeric,'a', 1,2.000000::numeric+1.000000::numeric; 
SELECT * FROM computedcol_dml_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 1.000000 | 3.000000 | a    | 3.000000 |    1
 3.000000 | 3.000000 | a    | 3.000000 |    1
(2 rows)

UPDATE computedcol_dml_numeric SET col1=2.000000::numeric+1.000000::numeric;
SELECT * FROM computedcol_dml_numeric ORDER BY 1,2,3,4;
   col1   |   col2   | col3 |   col4   | col5 
----------+----------+------+----------+------
 3.000000 | 3.000000 | a    | 3.000000 |    1
 3.000000 | 3.000000 | a    | 3.000000 |    1
(2 rows)

DELETE FROM computedcol_dml_numeric WHERE col1=1.000000::numeric + 2.000000::numeric;
SELECT * FROM computedcol_dml_numeric ORDER BY 1,2,3,4;
 col1 | col2 | col3 | col4 | col5 
------+------+------+------+------
(0 rows)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description Mpp-19671
SET test_print_direct_dispatch_info = on;
SET gp_autostats_mode=none;
--start_ignore
DROP TABLE IF EXISTS T;
NOTICE:  table "t" does not exist, skipping
--end_ignore
CREATE TABLE T ( a int , b int ) DISTRIBUTED BY (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
INSERT INTO T VALUES (1,2);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
INSERT INTO T VALUES (1,2);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Insert on AO tables within transaction
DROP TABLE IF EXISTS dml_ao;
NOTICE:  table "dml_ao" does not exist, skipping
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_ao;
NOTICE:  table "dml_ao" does not exist, skipping
    CREATE TABLE dml_ao (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p1" for table "dml_ao"
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p2" for table "dml_ao"
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p3" for table "dml_ao"
SAVEPOINT sp2;
    INSERT INTO dml_ao values (1,'to be exchanged','a','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
ROLLBACK to sp2;
    INSERT INTO dml_ao values (1,'exchanged','a','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_ao;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

SELECT x FROM dml_ao;
INFO:  Dispatch command to ALL contents
     x     
-----------
 exchanged
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Negative test - Update on AO tables within transaction
DROP TABLE IF EXISTS dml_ao;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_ao;
NOTICE:  table "dml_ao" does not exist, skipping
    CREATE TABLE dml_ao (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p1" for table "dml_ao"
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p2" for table "dml_ao"
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p3" for table "dml_ao"
    INSERT INTO dml_ao values (7,'to be exchanged','s','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
SAVEPOINT sp2;
    UPDATE dml_ao SET x = 'update_ao';
INFO:  Dispatch command to ALL contents
RELEASE SAVEPOINT sp2;
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_ao;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

SELECT x FROM dml_ao;
INFO:  Dispatch command to ALL contents
     x     
-----------
 update_ao
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Negative test - Delete on AO tables within transaction
DROP TABLE IF EXISTS dml_ao;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_ao;
NOTICE:  table "dml_ao" does not exist, skipping
    CREATE TABLE dml_ao (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p1" for table "dml_ao"
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p2" for table "dml_ao"
NOTICE:  CREATE TABLE will create partition "dml_ao_1_prt_p3" for table "dml_ao"
    INSERT INTO dml_ao values(generate_series(1,9),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
SAVEPOINT sp2;
    DELETE FROM dml_ao;
INFO:  Dispatch command to ALL contents
RELEASE SAVEPOINT sp2;
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_ao;
INFO:  Dispatch command to ALL contents
 count 
-------
     0
(1 row)

SELECT x FROM dml_ao;
INFO:  Dispatch command to ALL contents
 x 
---
(0 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for bigint
DROP TABLE IF EXISTS dml_tab_bigint;
NOTICE:  table "dml_tab_bigint" does not exist, skipping
CREATE TABLE dml_tab_bigint (a bigint DEFAULT 1234567891011) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_tab_bigint values(-9223372036854775808);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
INSERT INTO dml_tab_bigint values(9223372036854775807);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
  9223372036854775807
(2 rows)

INSERT INTO dml_tab_bigint DEFAULT VALUES;
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
        1234567891011
  9223372036854775807
(3 rows)

UPDATE dml_tab_bigint SET a = 9223372036854775807;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 9223372036854775807
 9223372036854775807
 9223372036854775807
(3 rows)

UPDATE dml_tab_bigint SET a = -9223372036854775808;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
 -9223372036854775808
 -9223372036854775808
(3 rows)

-- OUT OF RANGE
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
 -9223372036854775808
 -9223372036854775808
(3 rows)

INSERT INTO dml_tab_bigint values(-9223372036854775809);
ERROR:  bigint out of range
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
 -9223372036854775808
 -9223372036854775808
(3 rows)

INSERT INTO dml_tab_bigint values(9223372036854775808);
ERROR:  bigint out of range
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
 -9223372036854775808
 -9223372036854775808
(3 rows)

UPDATE dml_tab_bigint SET a = -9223372036854775809;
ERROR:  bigint out of range
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
 -9223372036854775808
 -9223372036854775808
(3 rows)

UPDATE dml_tab_bigint SET a = 9223372036854775808;
ERROR:  bigint out of range
SELECT * FROM dml_tab_bigint ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a           
----------------------
 -9223372036854775808
 -9223372036854775808
 -9223372036854775808
(3 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for bigserial
DROP TABLE IF EXISTS dml_bigserial;
NOTICE:  table "dml_bigserial" does not exist, skipping
CREATE TABLE dml_bigserial (a bigserial) distributed by (a);
NOTICE:  CREATE TABLE will create implicit sequence "dml_bigserial_a_seq" for serial column "dml_bigserial.a"
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_bigserial VALUES(9223372036854775807);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_bigserial ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 9223372036854775807
(1 row)

INSERT INTO dml_bigserial VALUES(0);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_bigserial ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
                   0
 9223372036854775807
(2 rows)

UPDATE dml_bigserial SET a = 9223372036854775807;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_bigserial ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 9223372036854775807
 9223372036854775807
(2 rows)

UPDATE dml_bigserial SET a = 0;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_bigserial ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

-- OUT OF RANGE
INSERT INTO dml_bigserial VALUES(9223372036854775808);
ERROR:  bigint out of range
SELECT * FROM dml_bigserial ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

UPDATE dml_bigserial SET a = 9223372036854775808;
ERROR:  bigint out of range
SELECT * FROM dml_bigserial ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for bit
DROP TABLE IF EXISTS dml_bit;
NOTICE:  table "dml_bit" does not exist, skipping
CREATE TABLE dml_bit( a bit ) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_bit VALUES('1');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_bit ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 1
(1 row)

UPDATE dml_bit SET a = '0';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_bit ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
(1 row)

-- OUT OF RANGE VALUES
INSERT INTO dml_bit VALUES('True');
ERROR:  "T" is not a valid binary digit
LINE 1: INSERT INTO dml_bit VALUES('True');
                                   ^
SELECT * FROM dml_bit ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
(1 row)

INSERT INTO dml_bit VALUES('11');
ERROR:  bit string length 2 does not match type bit(1)
SELECT * FROM dml_bit ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
(1 row)

UPDATE dml_bit SET a = '00';
ERROR:  bit string length 2 does not match type bit(1)
SELECT * FROM dml_bit ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for bit varying
DROP TABLE IF EXISTS dml_bitvarying;
NOTICE:  table "dml_bitvarying" does not exist, skipping
CREATE TABLE dml_bitvarying( a bit varying(2)) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_bitvarying VALUES('11');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_bitvarying ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a  
----
 11
(1 row)

UPDATE dml_bitvarying SET a = '00';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_bitvarying ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a  
----
 00
(1 row)

-- OUT OF RANGE VALUES
INSERT INTO dml_bitvarying VALUES('111');
ERROR:  bit string too long for type bit varying(2)
SELECT * FROM dml_bitvarying ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a  
----
 00
(1 row)

UPDATE dml_bitvarying SET a = '000';
ERROR:  bit string too long for type bit varying(2)
SELECT * FROM dml_bitvarying ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a  
----
 00
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for bool
DROP TABLE IF EXISTS dml_bool;
NOTICE:  table "dml_bool" does not exist, skipping
CREATE TABLE dml_bool (a bool) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_bool VALUES('True');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_bool ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 t
(1 row)

INSERT INTO dml_bool VALUES('False');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_bool ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 f
 t
(2 rows)

UPDATE dml_bool SET a = 'True';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_bool ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 t
 t
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for bytea
DROP TABLE IF EXISTS dml_bytea;
NOTICE:  table "dml_bytea" does not exist, skipping
CREATE TABLE dml_bytea( a bytea) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_bytea VALUES(pg_catalog.decode(array_to_string(ARRAY(SELECT chr((65 + round(random() * 25)) :: integer) FROM generate_series(1, 10490000)), ''),'escape'));
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_bytea;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

UPDATE dml_bytea SET a = pg_catalog.decode(array_to_string(ARRAY(SELECT chr((65 + round(random() * 25)) :: integer) FROM generate_series(1, 10490000)), ''),'escape'); 
ERROR:  Cannot parallelize an UPDATE statement that updates the distribution columns
-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for char
DROP TABLE IF EXISTS dml_char;
NOTICE:  table "dml_char" does not exist, skipping
CREATE TABLE dml_char( a char) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_char VALUES('1');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_char ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 1
(1 row)

UPDATE dml_char SET a = 'b';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_char ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 b
(1 row)

-- OUT OF RANGE VALUES
INSERT INTO dml_char VALUES('ab');
ERROR:  value too long for type character(1)
SELECT * FROM dml_char ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 b
(1 row)

INSERT INTO dml_char VALUES('-a');
ERROR:  value too long for type character(1)
SELECT * FROM dml_char ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 b
(1 row)

UPDATE dml_char SET a ='-1';
ERROR:  value too long for type character(1)
SELECT * FROM dml_char ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 b
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for cidr
DROP TABLE IF EXISTS dml_cidr;
NOTICE:  table "dml_cidr" does not exist, skipping
CREATE TABLE dml_cidr (a cidr) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_cidr VALUES('192.168.100.128/25');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.100.128/25
(1 row)

INSERT INTO dml_cidr VALUES('128');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 128.0.0.0/16
 192.168.100.128/25
(2 rows)

INSERT INTO dml_cidr VALUES('2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
                  a                   
--------------------------------------
 128.0.0.0/16
 192.168.100.128/25
 2001:4f8:3:ba:2e0:81ff:fe22:d1f1/128
(3 rows)

UPDATE dml_cidr SET a = '192.168.100.128/25';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.100.128/25
 192.168.100.128/25
 192.168.100.128/25
(3 rows)

-- OUT OF RANGE
INSERT INTO dml_cidr VALUES('204.248.199.199/30');
ERROR:  invalid cidr value: "204.248.199.199/30"
LINE 1: INSERT INTO dml_cidr VALUES('204.248.199.199/30');
                                    ^
DETAIL:  Value has bits set to right of mask.
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.100.128/25
 192.168.100.128/25
 192.168.100.128/25
(3 rows)

INSERT INTO dml_cidr VALUES('2001:4f8:3:ba:2e0:81ff:fe22:d1f1/120');
ERROR:  invalid cidr value: "2001:4f8:3:ba:2e0:81ff:fe22:d1f1/120"
LINE 1: INSERT INTO dml_cidr VALUES('2001:4f8:3:ba:2e0:81ff:fe22:d1f...
                                    ^
DETAIL:  Value has bits set to right of mask.
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.100.128/25
 192.168.100.128/25
 192.168.100.128/25
(3 rows)

UPDATE dml_cidr SET a = '204.248.199.199/30';
ERROR:  invalid cidr value: "204.248.199.199/30"
LINE 1: UPDATE dml_cidr SET a = '204.248.199.199/30';
                                ^
DETAIL:  Value has bits set to right of mask.
SELECT * FROM dml_cidr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.100.128/25
 192.168.100.128/25
 192.168.100.128/25
(3 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for date
DROP TABLE IF EXISTS dml_date;
NOTICE:  table "dml_date" does not exist, skipping
CREATE TABLE dml_date ( a date) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_date VALUES ('2013-01-01 08:00:00.000000'::date);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
     a      
------------
 01-01-2013
(1 row)

INSERT INTO dml_date VALUES ('4713-01-01 BC');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
       a       
---------------
 01-01-4713 BC
 01-01-2013
(2 rows)

INSERT INTO dml_date select to_date('3232098', 'MM/DD/YYYY');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
       a       
---------------
 06-26-4568 BC
 01-01-4713 BC
 01-01-2013
(3 rows)

UPDATE dml_date SET a = '4713-01-01 BC';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
       a       
---------------
 01-01-4713 BC
 01-01-4713 BC
 01-01-4713 BC
(3 rows)

-- OUT OF RANGE VALUES
INSERT INTO dml_date VALUES ('0000-01-01 08:00:00.000000'::date);
ERROR:  date/time field value out of range: "0000-01-01 08:00:00.000000"
LINE 1: INSERT INTO dml_date VALUES ('0000-01-01 08:00:00.000000'::d...
                                     ^
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
       a       
---------------
 01-01-4713 BC
 01-01-4713 BC
 01-01-4713 BC
(3 rows)

INSERT INTO dml_date VALUES ('4714-01-01 BC');
ERROR:  date out of range: "4714-01-01 BC"
LINE 1: INSERT INTO dml_date VALUES ('4714-01-01 BC');
                                     ^
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
       a       
---------------
 01-01-4713 BC
 01-01-4713 BC
 01-01-4713 BC
(3 rows)

UPDATE dml_date SET a = '4714-01-01 BC';
ERROR:  date out of range: "4714-01-01 BC"
LINE 1: UPDATE dml_date SET a = '4714-01-01 BC';
                                ^
SELECT * FROM dml_date ORDER BY 1;
INFO:  Dispatch command to ALL contents
       a       
---------------
 01-01-4713 BC
 01-01-4713 BC
 01-01-4713 BC
(3 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for double precision
DROP TABLE IF EXISTS dml_dp;
NOTICE:  table "dml_dp" does not exist, skipping
CREATE TABLE dml_dp ( a double precision) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_dp VALUES('5.7107617381473e+45');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_dp ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 5.7107617381473e+45
(1 row)

INSERT INTO dml_dp VALUES('5.7107617381473e-10');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_dp ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 5.7107617381473e-10
 5.7107617381473e+45
(2 rows)

UPDATE dml_dp SET a = 5.7107617381473e+45;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_dp ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 5.7107617381473e+45
 5.7107617381473e+45
(2 rows)

-- OUT OF RANGE
INSERT INTO dml_dp VALUES('5.7107617381473e+1000');
ERROR:  value out of range: overflow
LINE 1: INSERT INTO dml_dp VALUES('5.7107617381473e+1000');
                                  ^
SELECT * FROM dml_dp ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 5.7107617381473e+45
 5.7107617381473e+45
(2 rows)

INSERT INTO dml_dp VALUES('5.7107617381473e-1000');
ERROR:  value out of range: underflow
LINE 1: INSERT INTO dml_dp VALUES('5.7107617381473e-1000');
                                  ^
SELECT * FROM dml_dp ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 5.7107617381473e+45
 5.7107617381473e+45
(2 rows)

UPDATE dml_dp SET a = 5.7107617381473e+1000;
ERROR:  value out of range: overflow
SELECT * FROM dml_dp ORDER BY 1;
INFO:  Dispatch command to ALL contents
          a          
---------------------
 5.7107617381473e+45
 5.7107617381473e+45
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for inet
DROP TABLE IF EXISTS dml_inet;
NOTICE:  table "dml_inet" does not exist, skipping
CREATE TABLE dml_inet(a inet) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_inet VALUES ('192.168.1.6');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 192.168.1.6
(1 row)

INSERT INTO dml_inet VALUES ('204.248.199.199/30');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.1.6
 204.248.199.199/30
(2 rows)

INSERT INTO dml_inet VALUES('::1');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 192.168.1.6
 204.248.199.199/30
 ::1
(3 rows)

UPDATE dml_inet SET a = '::1';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 ::1
 ::1
 ::1
(3 rows)

-- OUT OF RANGE VALUES
INSERT INTO dml_inet VALUES ('192.168.23.20/33');
ERROR:  invalid input syntax for type inet: "192.168.23.20/33"
LINE 1: INSERT INTO dml_inet VALUES ('192.168.23.20/33');
                                     ^
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 ::1
 ::1
 ::1
(3 rows)

INSERT INTO dml_inet VALUES('');
ERROR:  invalid input syntax for type inet: ""
LINE 1: INSERT INTO dml_inet VALUES('');
                                    ^
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 ::1
 ::1
 ::1
(3 rows)

UPDATE dml_inet SET a = '192.168.23.20/33';
ERROR:  invalid input syntax for type inet: "192.168.23.20/33"
LINE 1: UPDATE dml_inet SET a = '192.168.23.20/33';
                                ^
SELECT * FROM dml_inet ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 ::1
 ::1
 ::1
(3 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @gpopt 1.473
-- @description test1: Boundary test for integer array
DROP TABLE IF EXISTS dml_intarr;
NOTICE:  table "dml_intarr" does not exist, skipping
CREATE TABLE dml_intarr (a integer[] DEFAULT '{5,4,3,2,1}') distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_intarr VALUES('{6,7,8,9,10}');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_intarr ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a       
--------------
 {6,7,8,9,10}
(1 row)

INSERT INTO dml_intarr DEFAULT VALUES;
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_intarr ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a       
--------------
 {5,4,3,2,1}
 {6,7,8,9,10}
(2 rows)

SELECT a[1] FROM dml_intarr ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 5
 6
(2 rows)

UPDATE dml_intarr SET a = '{11,12}';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_intarr ORDER BY 1;
INFO:  Dispatch command to ALL contents
    a    
---------
 {11,12}
 {11,12}
(2 rows)

UPDATE dml_intarr SET a[1] = 111;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT a[1] FROM dml_intarr ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 111
 111
(2 rows)

-- @author prabhd 
-- @CREATEd 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for integer
DROP TABLE IF EXISTS dml_integer;
NOTICE:  table "dml_integer" does not exist, skipping
CREATE TABLE dml_integer (a integer) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_integer VALUES(-2147483648);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
(1 row)

INSERT INTO dml_integer VALUES(2147483647);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
  2147483647
(2 rows)

UPDATE dml_integer SET a = 2147483647;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
     a      
------------
 2147483647
 2147483647
(2 rows)

UPDATE dml_integer SET a = -2147483648;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
 -2147483648
(2 rows)

-- OUT OF RANGE VALUES
INSERT INTO dml_integer VALUES(-2147483649);
ERROR:  integer out of range
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
 -2147483648
(2 rows)

INSERT INTO dml_integer VALUES(2147483648);
ERROR:  integer out of range
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
 -2147483648
(2 rows)

UPDATE dml_integer SET a = 2147483648;
ERROR:  integer out of range
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
 -2147483648
(2 rows)

UPDATE dml_integer SET a = -2147483649;
ERROR:  integer out of range
SELECT * FROM dml_integer ORDER BY 1;
INFO:  Dispatch command to ALL contents
      a      
-------------
 -2147483648
 -2147483648
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for interval
DROP TABLE IF EXISTS dml_interval;
NOTICE:  table "dml_interval" does not exist, skipping
CREATE TABLE dml_interval( a interval) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- SIMPLE INSERTS
INSERT INTO dml_interval VALUES('178000000 years');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_interval ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 @ 178000000 years
(1 row)

INSERT INTO dml_interval VALUES('-178000000 years');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_interval ORDER BY 1;
INFO:  Dispatch command to ALL contents
           a           
-----------------------
 @ 178000000 years ago
 @ 178000000 years
(2 rows)

UPDATE dml_interval SET a = '-178000000 years';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_interval ORDER BY 1;
INFO:  Dispatch command to ALL contents
           a           
-----------------------
 @ 178000000 years ago
 @ 178000000 years ago
(2 rows)

--OUT OF RANGE VALUES
INSERT INTO dml_interval VALUES('178000000 years 1 month');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_interval ORDER BY 1;
INFO:  Dispatch command to ALL contents
            a            
-------------------------
 @ 178000000 years ago
 @ 178000000 years ago
 @ 178000000 years 1 mon
(3 rows)

INSERT INTO dml_interval VALUES('-178000000 years 1 month');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_interval ORDER BY 1;
INFO:  Dispatch command to ALL contents
               a               
-------------------------------
 @ 178000000 years ago
 @ 178000000 years ago
 @ 177999999 years 11 mons ago
 @ 178000000 years 1 mon
(4 rows)

UPDATE dml_interval SET a = '-178000000 years 1 month';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_interval ORDER BY 1;
INFO:  Dispatch command to ALL contents
               a               
-------------------------------
 @ 177999999 years 11 mons ago
 @ 177999999 years 11 mons ago
 @ 177999999 years 11 mons ago
 @ 177999999 years 11 mons ago
(4 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for macaddr
DROP TABLE IF EXISTS dml_macaddr;
NOTICE:  table "dml_macaddr" does not exist, skipping
CREATE TABLE dml_macaddr( a macaddr) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- SIMPLE INSERTS
INSERT INTO dml_macaddr VALUES('08002b:010203');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_macaddr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 08:00:2b:01:02:03
(1 row)

UPDATE dml_macaddr SET a = 'FF:FF:FF:FF:FF:FF';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_macaddr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 ff:ff:ff:ff:ff:ff
(1 row)

--INVALID VALUES
INSERT INTO dml_macaddr VALUES('FF:FF:FF:FF:FF:FF0');
ERROR:  invalid octet value in "macaddr" value: "FF:FF:FF:FF:FF:FF0"
LINE 1: INSERT INTO dml_macaddr VALUES('FF:FF:FF:FF:FF:FF0');
                                       ^
SELECT * FROM dml_macaddr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 ff:ff:ff:ff:ff:ff
(1 row)

UPDATE dml_macaddr SET a = 'FF:FF:FF:FF:FF:FF0';
ERROR:  invalid octet value in "macaddr" value: "FF:FF:FF:FF:FF:FF0"
LINE 1: UPDATE dml_macaddr SET a = 'FF:FF:FF:FF:FF:FF0';
                                   ^
SELECT * FROM dml_macaddr ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 ff:ff:ff:ff:ff:ff
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @skip 'Money datatype was enlarged to 64 bits in PostgreSQL 8.3 so will be tested via installcheck-good' 
-- @db_name dmldb
-- @description test: Boundary test for money
DROP TABLE IF EXISTS dml_money;
NOTICE:  table "dml_money" does not exist, skipping
CREATE TABLE dml_money (a money) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- SIMPLE INSERTS
INSERT INTO dml_money VALUES('-2147483648'::money);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 -$2,147,483,648.00
(1 row)

INSERT INTO dml_money VALUES('2147483647'::money);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 -$2,147,483,648.00
  $2,147,483,647.00
(2 rows)

UPDATE dml_money SET a = '2147483647'::money;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 $2,147,483,647.00
 $2,147,483,647.00
(2 rows)

UPDATE dml_money SET a = '-2147483648'::money;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 -$2,147,483,648.00
 -$2,147,483,648.00
(2 rows)

-- OUT OF RANGE (no error observed)
INSERT INTO dml_money VALUES('-2147483649'::money);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 -$2,147,483,649.00
 -$2,147,483,648.00
 -$2,147,483,648.00
(3 rows)

INSERT INTO dml_money VALUES('2147483648'::money);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 -$2,147,483,649.00
 -$2,147,483,648.00
 -$2,147,483,648.00
  $2,147,483,648.00
(4 rows)

UPDATE dml_money SET a = '2147483648'::money;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a         
-------------------
 $2,147,483,648.00
 $2,147,483,648.00
 $2,147,483,648.00
 $2,147,483,648.00
(4 rows)

UPDATE dml_money SET a = '-2147483649'::money;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_money ORDER BY 1;
INFO:  Dispatch command to ALL contents
         a          
--------------------
 -$2,147,483,649.00
 -$2,147,483,649.00
 -$2,147,483,649.00
 -$2,147,483,649.00
(4 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for numeric
DROP TABLE IF EXISTS dml_numeric;
NOTICE:  table "dml_numeric" does not exist, skipping
CREATE TABLE dml_numeric( a numeric) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_numeric VALUES (10e+1000);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_numeric ORDER BY 1;
INFO:  Dispatch command to ALL contents
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(1 row)

INSERT INTO dml_numeric VALUES (1e-1000);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_numeric ORDER BY 1;
INFO:  Dispatch command to ALL contents
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(2 rows)

-- OUT OF RANGE
INSERT INTO dml_numeric VALUES (1e+10000);
ERROR:  invalid input syntax for type numeric: "1e+10000"
LINE 1: INSERT INTO dml_numeric VALUES (1e+10000);
                                        ^
SELECT * FROM dml_numeric ORDER BY 1;
INFO:  Dispatch command to ALL contents
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(2 rows)

UPDATE dml_numeric SET a = 1e+10000;
ERROR:  invalid input syntax for type numeric: "1e+10000"
LINE 1: UPDATE dml_numeric SET a = 1e+10000;
                                   ^
SELECT * FROM dml_numeric ORDER BY 1;
INFO:  Dispatch command to ALL contents
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     a                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001
 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for numeric
DROP TABLE IF EXISTS dml_numeric2;
NOTICE:  table "dml_numeric2" does not exist, skipping
CREATE TABLE dml_numeric2(a numeric(5,2)) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT  INTO  dml_numeric2 VALUES (1.00e+2);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_numeric2 ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 100.00
(1 row)

UPDATE dml_numeric2 SET a = 1.00e+1;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_numeric2 ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a   
-------
 10.00
(1 row)

--OUT OF RANGE
INSERT  INTO  dml_numeric2 VALUES (1.00e+3);
ERROR:  numeric field overflow
DETAIL:  A field with precision 5, scale 2 must round to an absolute value less than 10^3. Rounded overflowing value: 1000.00
SELECT * FROM dml_numeric2 ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a   
-------
 10.00
(1 row)

UPDATE dml_numeric2 SET a = 1.00e+3;
ERROR:  numeric field overflow
DETAIL:  A field with precision 5, scale 2 must round to an absolute value less than 10^3. Rounded overflowing value: 1000.00
SELECT * FROM dml_numeric2 ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a   
-------
 10.00
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for real
DROP TABLE IF EXISTS dml_real;
NOTICE:  table "dml_real" does not exist, skipping
CREATE TABLE dml_real ( a real) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_real VALUES(0);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_real ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
(1 row)

INSERT INTO dml_real VALUES('-1.18e-38');
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_real ORDER BY 1;
INFO:  Dispatch command to ALL contents
     a     
-----------
 -1.18e-38
         0
(2 rows)

UPDATE dml_real SET a = 0;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_real ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

-- OUT OF RANGE VALUES
INSERT INTO dml_real VALUES('-3.40e+39');
ERROR:  value out of range: overflow
LINE 1: INSERT INTO dml_real VALUES('-3.40e+39');
                                    ^
SELECT * FROM dml_real ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

INSERT INTO dml_real VALUES('-1.00e-46');
ERROR:  value out of range: underflow
LINE 1: INSERT INTO dml_real VALUES('-1.00e-46');
                                    ^
SELECT * FROM dml_real ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

UPDATE dml_real SET a = '-1.00e-46';
ERROR:  value out of range: underflow
LINE 1: UPDATE dml_real SET a = '-1.00e-46';
                                ^
SELECT * FROM dml_real ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 0
 0
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for smallint
DROP TABLE IF EXISTS dml_tab_smallint;
NOTICE:  table "dml_tab_smallint" does not exist, skipping
CREATE TABLE dml_tab_smallint (a smallint) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_tab_smallint values(-32768);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
(1 row)

INSERT INTO dml_tab_smallint values(32767);
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
  32767
(2 rows)

UPDATE dml_tab_smallint SET a = 32767;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a   
-------
 32767
 32767
(2 rows)

UPDATE dml_tab_smallint SET a = -32768;
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
 -32768
(2 rows)

-- OUT OF RANGE
INSERT INTO dml_tab_smallint values(-32769);
ERROR:  smallint out of range
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
 -32768
(2 rows)

INSERT INTO dml_tab_smallint values(32768);
ERROR:  smallint out of range
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
 -32768
(2 rows)

UPDATE dml_tab_smallint SET a = 32768;
ERROR:  smallint out of range
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
 -32768
(2 rows)

UPDATE dml_tab_smallint SET a = -32769;
ERROR:  smallint out of range
SELECT * FROM dml_tab_smallint ORDER BY 1;
INFO:  Dispatch command to ALL contents
   a    
--------
 -32768
 -32768
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test1: Boundary test for text
DROP TABLE IF EXISTS dml_text;
NOTICE:  table "dml_text" does not exist, skipping
CREATE TABLE dml_text( a text) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_text VALUES(array_to_string(ARRAY(SELECT chr((65 + round(random() * 25)) :: integer) FROM generate_series(1, 10490000)), ''));
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
UPDATE dml_text SET a = array_to_string(ARRAY(SELECT chr((65 + round(random() * 25)) :: integer) FROM generate_series(1, 10490000)), '');
ERROR:  Cannot parallelize an UPDATE statement that updates the distribution columns
-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for timestamp
DROP TABLE IF EXISTS dml_timestamp;
NOTICE:  table "dml_timestamp" does not exist, skipping
CREATE TABLE dml_timestamp( a timestamp) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_timestamp VALUES (to_date('2012-02-31', 'YYYY-MM-DD BC'));
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_timestamp ORDER BY 1;
INFO:  Dispatch command to ALL contents
            a             
--------------------------
 Fri Mar 02 00:00:00 2012
(1 row)

INSERT INTO dml_timestamp VALUES (to_date('4714-01-27 AD', 'YYYY-MM-DD BC'));
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_timestamp ORDER BY 1;
INFO:  Dispatch command to ALL contents
            a             
--------------------------
 Fri Mar 02 00:00:00 2012
 Tue Jan 27 00:00:00 4714
(2 rows)

UPDATE dml_timestamp SET a = to_date('2012-02-31', 'YYYY-MM-DD BC');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_timestamp ORDER BY 1;
INFO:  Dispatch command to ALL contents
            a             
--------------------------
 Fri Mar 02 00:00:00 2012
 Fri Mar 02 00:00:00 2012
(2 rows)

-- OUT OF RANGE VALUES
INSERT INTO dml_timestamp VALUES ('294277-01-27 AD'::timestamp);
ERROR:  timestamp out of range: "294277-01-27 AD"
LINE 1: INSERT INTO dml_timestamp VALUES ('294277-01-27 AD'::timesta...
                                          ^
SELECT * FROM dml_timestamp ORDER BY 1;
INFO:  Dispatch command to ALL contents
            a             
--------------------------
 Fri Mar 02 00:00:00 2012
 Fri Mar 02 00:00:00 2012
(2 rows)

UPDATE dml_timestamp SET a = '294277-01-27 AD'::timestamp;
ERROR:  timestamp out of range: "294277-01-27 AD"
LINE 1: UPDATE dml_timestamp SET a = '294277-01-27 AD'::timestamp;
                                     ^
SELECT * FROM dml_timestamp ORDER BY 1;
INFO:  Dispatch command to ALL contents
            a             
--------------------------
 Fri Mar 02 00:00:00 2012
 Fri Mar 02 00:00:00 2012
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for timestamptz
DROP TABLE IF EXISTS dml_timestamptz;
NOTICE:  table "dml_timestamptz" does not exist, skipping
CREATE TABLE dml_timestamptz( a timestamptz) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_timestamptz VALUES (to_date('4714-01-27 AD', 'YYYY-MM-DD BC'));
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
SELECT * FROM dml_timestamptz ORDER BY 1;
INFO:  Dispatch command to ALL contents
              a               
------------------------------
 Tue Jan 27 00:00:00 4714 PST
(1 row)

UPDATE dml_timestamptz SET a = to_date('4714-01-27 AD', 'YYYY-MM-DD BC');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_timestamptz ORDER BY 1;
INFO:  Dispatch command to ALL contents
              a               
------------------------------
 Tue Jan 27 00:00:00 4714 PST
(1 row)

-- OUT OF RANGE VALUES
INSERT INTO dml_timestamptz VALUES ('294277-01-27 AD'::timestamptz);
ERROR:  timestamp out of range: "294277-01-27 AD"
LINE 1: INSERT INTO dml_timestamptz VALUES ('294277-01-27 AD'::times...
                                            ^
SELECT * FROM dml_timestamptz ORDER BY 1;
INFO:  Dispatch command to ALL contents
              a               
------------------------------
 Tue Jan 27 00:00:00 4714 PST
(1 row)

INSERT INTO dml_timestamptz VALUES ('4714-01-27 BC'::timestamptz);
ERROR:  timestamp out of range: "4714-01-27 BC"
LINE 1: INSERT INTO dml_timestamptz VALUES ('4714-01-27 BC'::timesta...
                                            ^
SELECT * FROM dml_timestamptz ORDER BY 1;
INFO:  Dispatch command to ALL contents
              a               
------------------------------
 Tue Jan 27 00:00:00 4714 PST
(1 row)

UPDATE dml_timestamptz SET a = '4714-01-27 BC'::timestamptz;
ERROR:  timestamp out of range: "4714-01-27 BC"
LINE 1: UPDATE dml_timestamptz SET a = '4714-01-27 BC'::timestamptz;
                                       ^
SELECT * FROM dml_timestamptz ORDER BY 1;
INFO:  Dispatch command to ALL contents
              a               
------------------------------
 Tue Jan 27 00:00:00 4714 PST
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for varchar
DROP TABLE IF EXISTS dml_var;
NOTICE:  table "dml_var" does not exist, skipping
CREATE TABLE dml_var( a varchar(10485760)) distributed by (a);
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_var VALUES(repeat('x',10485760));
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
UPDATE dml_var SET a = 'y';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_var ORDER BY 1;
INFO:  Dispatch command to ALL contents
 a 
---
 y
(1 row)

-- OUT OF RANGE
INSERT INTO dml_var VALUES(repeat('x',10485761));
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Abort (No Prepared)' to ALL contents
ERROR:  value too long for type character varying(10485760)  (seg2 127.0.0.1:25434 pid=55579)
UPDATE dml_var SET a = repeat('x',10485761);
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Abort (No Prepared)' to ALL contents
ERROR:  value too long for type character varying(10485760)  (seg2 slice1 127.0.0.1:25434 pid=55582)
-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for box
DROP TABLE IF EXISTS dml_box;
NOTICE:  table "dml_box" does not exist, skipping
CREATE TABLE dml_box(a box) DISTRIBUTED RANDOMLY;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_box VALUES ('(8,9), (1,3)');
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT area((select * from dml_box));
INFO:  Dispatch command to ALL contents
 area 
------
   42
(1 row)

UPDATE dml_box SET a = '(1,1), (1,1)';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT area((select * from dml_box));
INFO:  Dispatch command to ALL contents
 area 
------
    0
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test1: Boundary test for circle
DROP TABLE IF EXISTS dml_circle;
NOTICE:  table "dml_circle" does not exist, skipping
CREATE TABLE dml_circle(a circle) DISTRIBUTED RANDOMLY;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_circle VALUES ('10, 4, 10');
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT area((select * from dml_circle));
INFO:  Dispatch command to ALL contents
       area       
------------------
 314.159265358979
(1 row)

UPDATE dml_circle SET a = '1,1,1';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT area((select * from dml_circle));
INFO:  Dispatch command to ALL contents
       area       
------------------
 3.14159265358979
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Insert on CO tables within transaction
DROP TABLE IF EXISTS dml_co;
NOTICE:  table "dml_co" does not exist, skipping
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_co;
NOTICE:  table "dml_co" does not exist, skipping
    CREATE TABLE dml_co (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true, orientation=column) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p1" for table "dml_co"
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p2" for table "dml_co"
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p3" for table "dml_co"
SAVEPOINT sp2;
    INSERT INTO dml_co values (1,'to be exchanged','a','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
ROLLBACK to sp2;
    INSERT INTO dml_co values (1,'exchanged','a','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_co;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

SELECT x FROM dml_co;
INFO:  Dispatch command to ALL contents
     x     
-----------
 exchanged
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Negative test - Update on CO tables within transaction
DROP TABLE IF EXISTS dml_co;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_co;
NOTICE:  table "dml_co" does not exist, skipping
    CREATE TABLE dml_co (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true, orientation=column) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p1" for table "dml_co"
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p2" for table "dml_co"
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p3" for table "dml_co"
    INSERT INTO dml_co values (7,'to be exchanged','s','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
SAVEPOINT sp2;
    UPDATE dml_co SET x = 'update_co';
INFO:  Dispatch command to ALL contents
RELEASE SAVEPOINT sp2;
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_co;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

SELECT x FROM dml_co;
INFO:  Dispatch command to ALL contents
     x     
-----------
 update_co
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Negative test - Delete on CO tables within transaction
DROP TABLE IF EXISTS dml_co;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_co;
NOTICE:  table "dml_co" does not exist, skipping
    CREATE TABLE dml_co (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true, orientation=column) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p1" for table "dml_co"
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p2" for table "dml_co"
NOTICE:  CREATE TABLE will create partition "dml_co_1_prt_p3" for table "dml_co"
    INSERT INTO dml_co values(generate_series(1,9),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
SAVEPOINT sp2;
    DELETE FROM dml_co;
INFO:  Dispatch command to ALL contents
RELEASE SAVEPOINT sp2;
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_co;
INFO:  Dispatch command to ALL contents
 count 
-------
     0
(1 row)

SELECT x FROM dml_co;
INFO:  Dispatch command to ALL contents
 x 
---
(0 rows)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Insert on heap tables within transaction
DROP TABLE IF EXISTS dml_heap;
NOTICE:  table "dml_heap" does not exist, skipping
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_heap;
NOTICE:  table "dml_heap" does not exist, skipping
    CREATE TABLE dml_heap (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p1" for table "dml_heap"
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p2" for table "dml_heap"
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p3" for table "dml_heap"
SAVEPOINT sp2;
    INSERT INTO dml_heap values (1,'to be exchanged','a','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
ROLLBACK to sp2;
    INSERT INTO dml_heap values (1,'to be exchanged','a','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_heap;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Insert on heap tables within transaction 
DROP TABLE IF EXISTS dml_heap;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_heap;
NOTICE:  table "dml_heap" does not exist, skipping
    CREATE TABLE dml_heap (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p1" for table "dml_heap"
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p2" for table "dml_heap"
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p3" for table "dml_heap"
    INSERT INTO dml_heap values (7,'to be exchanged','s','partition table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to SINGLE content
SAVEPOINT sp2;
    UPDATE dml_heap SET x = 'update';
INFO:  Dispatch command to ALL contents
RELEASE SAVEPOINT sp2;
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_heap;
INFO:  Dispatch command to ALL contents
 count 
-------
     1
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Insert on heap tables within transaction 
DROP TABLE IF EXISTS dml_heap;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
BEGIN;
SAVEPOINT sp1;
    DROP TABLE IF EXISTS dml_heap;
NOTICE:  table "dml_heap" does not exist, skipping
    CREATE TABLE dml_heap (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed by (i) partition by range (i) (partition p1 start(1) end(5),partition p2 start(5) end(8), partition p3 start(8) end(10) );
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p1" for table "dml_heap"
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p2" for table "dml_heap"
NOTICE:  CREATE TABLE will create partition "dml_heap_1_prt_p3" for table "dml_heap"
    INSERT INTO dml_heap values(generate_series(1,9),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
SAVEPOINT sp2;
    DELETE FROM dml_heap;
INFO:  Dispatch command to ALL contents
RELEASE SAVEPOINT sp2;
RELEASE SAVEPOINT sp1;
COMMIT;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT COUNT(*) FROM dml_heap;
INFO:  Dispatch command to ALL contents
 count 
-------
     0
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for path
DROP TABLE IF EXISTS dml_path;
NOTICE:  table "dml_path" does not exist, skipping
CREATE TABLE dml_path(a path) DISTRIBUTED RANDOMLY;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_path VALUES ('(3,1), (2,8), (10,4)');
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT length((select * from dml_path));
INFO:  Dispatch command to ALL contents
      length      
------------------
 23.6311128277285
(1 row)

UPDATE dml_path SET a = '(4,2), (3,2), (11,5)';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT length((select * from dml_path));
INFO:  Dispatch command to ALL contents
      length      
------------------
 17.1597768511814
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for point
DROP TABLE IF EXISTS dml_point;
NOTICE:  table "dml_point" does not exist, skipping
CREATE TABLE dml_point(a point) DISTRIBUTED RANDOMLY;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML
INSERT INTO dml_point VALUES ('1,2');
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_point;
INFO:  Dispatch command to ALL contents
   a   
-------
 (1,2)
(1 row)

UPDATE dml_point SET a = '2,3';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_point;
INFO:  Dispatch command to ALL contents
   a   
-------
 (2,3)
(1 row)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test: Boundary test for polygon
DROP TABLE IF EXISTS dml_polygon;
NOTICE:  table "dml_polygon" does not exist, skipping
CREATE TABLE dml_polygon (a polygon) DISTRIBUTED RANDOMLY;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- Simple DML 
INSERT INTO dml_polygon VALUES ('((2,2),(3,4),(3,6),(1,1))');
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT point(a) FROM dml_polygon;
INFO:  Dispatch command to ALL contents
    point    
-------------
 (2.25,3.25)
(1 row)

UPDATE dml_polygon SET a = '((2,2),(3,3),(4,4),(1,1))';
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT point(a) FROM dml_polygon;
INFO:  Dispatch command to ALL contents
   point   
-----------
 (2.5,2.5)
(1 row)

-- @author prabhd
-- @created 2012-12-05 12:00:00
-- @modified 2012-12-05 12:00:00
-- @tags dml
-- @db_name dmldb
-- @description test: Boundary test for serial
DROP SEQUENCE IF EXISTS serial;
NOTICE:  sequence "serial" does not exist, skipping
CREATE SEQUENCE serial START 101;
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
DROP TABLE IF EXISTS dml_serial;
NOTICE:  table "dml_serial" does not exist, skipping
CREATE TABLE dml_serial(a serial) distributed by (a);
NOTICE:  CREATE TABLE will create implicit sequence "dml_serial_a_seq" for serial column "dml_serial.a"
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
INSERT INTO dml_serial VALUES (nextval('serial'));
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
INSERT INTO dml_serial VALUES (nextval('serial'));
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_serial ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 101
 102
(2 rows)

UPDATE dml_serial set a = nextval('serial');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_serial ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 103
 104
(2 rows)

UPDATE dml_serial set a = nextval('serial');
INFO:  Dispatch command to ALL contents
INFO:  Dispatch command to ALL contents
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
SELECT * FROM dml_serial ORDER BY 1;
INFO:  Dispatch command to ALL contents
  a  
-----
 105
 106
(2 rows)

-- @author xiongg1 
-- @created 2015-01-20 12:00:00
-- @modified 2015-01-20 12:00:00
-- @tags dml ORCA
-- @product_version gpdb: [4.3.5.0-]
-- @description Tests for MPP-24621
select to_date('-4713-11-23', 'yyyy-mm-dd');
ERROR:  date out of range: "-4713-11-23"
select to_date('-4713-11-24', 'yyyy-mm-dd');
    to_date    
---------------
 11-24-4714 BC
(1 row)

select to_date('5874897-12-31', 'yyyy-mm-dd');
    to_date    
---------------
 12-31-5874897
(1 row)

select to_date('5874898-01-01', 'yyyy-mm-dd');
ERROR:  date out of range: "5874898-01-01"
-- start_ignore
drop table if exists t_to_date;
NOTICE:  table "t_to_date" does not exist, skipping
create table t_to_date(c1 date);
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 'c1' as the Greenplum Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- end_ignore
insert into t_to_date values (to_date('-4713-11-24', 'yyyy-mm-dd'));
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
insert into t_to_date values (to_date('5874897-12-31', 'yyyy-mm-dd'));
INFO:  Dispatch command to SINGLE content
INFO:  Distributed transaction command 'Distributed Prepare' to SINGLE content
INFO:  Distributed transaction command 'Distributed Commit Prepared' to SINGLE content
select * from t_to_date;
INFO:  Dispatch command to ALL contents
      c1       
---------------
 11-24-4714 BC
 12-31-5874897
(2 rows)

-- @author prabhd 
-- @created 2012-12-05 12:00:00 
-- @modified 2012-12-05 12:00:00 
-- @tags dml 
-- @db_name dmldb
-- @description test1: UDF with Insert
-- start_ignore
drop schema dml_functional_no_setup_1 cascade;
NOTICE:  drop cascades to table t_to_date
NOTICE:  drop cascades to table dml_serial
NOTICE:  drop cascades to default for table dml_serial column a
NOTICE:  drop cascades to sequence serial
NOTICE:  drop cascades to table dml_polygon
NOTICE:  drop cascades to table dml_point
NOTICE:  drop cascades to table dml_path
NOTICE:  drop cascades to table dml_heap_1_prt_p3
NOTICE:  drop cascades to constraint dml_heap_1_prt_p3_check on table dml_heap_1_prt_p3
NOTICE:  drop cascades to table dml_heap_1_prt_p2
NOTICE:  drop cascades to constraint dml_heap_1_prt_p2_check on table dml_heap_1_prt_p2
NOTICE:  drop cascades to table dml_heap_1_prt_p1
NOTICE:  drop cascades to constraint dml_heap_1_prt_p1_check on table dml_heap_1_prt_p1
NOTICE:  drop cascades to table dml_heap
NOTICE:  drop cascades to append only columnar table dml_co_1_prt_p3
NOTICE:  drop cascades to constraint dml_co_1_prt_p3_check on append only columnar table dml_co_1_prt_p3
NOTICE:  drop cascades to append only columnar table dml_co_1_prt_p2
NOTICE:  drop cascades to constraint dml_co_1_prt_p2_check on append only columnar table dml_co_1_prt_p2
NOTICE:  drop cascades to append only columnar table dml_co_1_prt_p1
NOTICE:  drop cascades to constraint dml_co_1_prt_p1_check on append only columnar table dml_co_1_prt_p1
NOTICE:  drop cascades to append only columnar table dml_co
NOTICE:  drop cascades to table dml_circle
NOTICE:  drop cascades to table dml_box
NOTICE:  drop cascades to table dml_var
NOTICE:  drop cascades to table dml_timestamptz
NOTICE:  drop cascades to table dml_timestamp
NOTICE:  drop cascades to table dml_text
NOTICE:  drop cascades to table dml_tab_smallint
NOTICE:  drop cascades to table dml_real
NOTICE:  drop cascades to table dml_numeric2
NOTICE:  drop cascades to table dml_numeric
NOTICE:  drop cascades to table dml_money
NOTICE:  drop cascades to table dml_macaddr
NOTICE:  drop cascades to table dml_interval
NOTICE:  drop cascades to table dml_integer
NOTICE:  drop cascades to table dml_intarr
NOTICE:  drop cascades to table dml_inet
NOTICE:  drop cascades to table dml_dp
NOTICE:  drop cascades to table dml_date
NOTICE:  drop cascades to table dml_cidr
NOTICE:  drop cascades to table dml_char
NOTICE:  drop cascades to table dml_bytea
NOTICE:  drop cascades to table dml_bool
NOTICE:  drop cascades to table dml_bitvarying
NOTICE:  drop cascades to table dml_bit
NOTICE:  drop cascades to table dml_bigserial
NOTICE:  drop cascades to default for table dml_bigserial column a
NOTICE:  drop cascades to table dml_tab_bigint
NOTICE:  drop cascades to append only table dml_ao_1_prt_p3
NOTICE:  drop cascades to constraint dml_ao_1_prt_p3_check on append only table dml_ao_1_prt_p3
NOTICE:  drop cascades to append only table dml_ao_1_prt_p2
NOTICE:  drop cascades to constraint dml_ao_1_prt_p2_check on append only table dml_ao_1_prt_p2
NOTICE:  drop cascades to append only table dml_ao_1_prt_p1
NOTICE:  drop cascades to constraint dml_ao_1_prt_p1_check on append only table dml_ao_1_prt_p1
NOTICE:  drop cascades to append only table dml_ao
NOTICE:  drop cascades to table t
NOTICE:  drop cascades to table computedcol_dml_numeric_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_numeric_1_prt_partthree_check on table computedcol_dml_numeric_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_numeric_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_numeric_1_prt_parttwo_check on append only table computedcol_dml_numeric_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_numeric_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_numeric_1_prt_partone_check on append only columnar table computedcol_dml_numeric_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_numeric_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_numeric
NOTICE:  drop cascades to table computedcol_dml_interval_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_interval_1_prt_partthree_check on table computedcol_dml_interval_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_interval_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_interval_1_prt_parttwo_check on append only table computedcol_dml_interval_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_interval_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_interval_1_prt_partone_check on append only columnar table computedcol_dml_interval_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_interval_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_interval
NOTICE:  drop cascades to table computedcol_dml_int8_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_int8_1_prt_partthree_check on table computedcol_dml_int8_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_int8_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_int8_1_prt_parttwo_check on append only table computedcol_dml_int8_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_int8_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_int8_1_prt_partone_check on append only columnar table computedcol_dml_int8_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_int8_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_int8
NOTICE:  drop cascades to table computedcol_dml_int4_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_int4_1_prt_partthree_check on table computedcol_dml_int4_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_int4_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_int4_1_prt_parttwo_check on append only table computedcol_dml_int4_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_int4_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_int4_1_prt_partone_check on append only columnar table computedcol_dml_int4_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_int4_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_int4
NOTICE:  drop cascades to table computedcol_dml_int_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_int_1_prt_partthree_check on table computedcol_dml_int_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_int_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_int_1_prt_parttwo_check on append only table computedcol_dml_int_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_int_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_int_1_prt_partone_check on append only columnar table computedcol_dml_int_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_int_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_int
NOTICE:  drop cascades to table computedcol_dml_float_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_float_1_prt_partthree_check on table computedcol_dml_float_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_float_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_float_1_prt_parttwo_check on append only table computedcol_dml_float_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_float_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_float_1_prt_partone_check on append only columnar table computedcol_dml_float_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_float_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_float
NOTICE:  drop cascades to table computedcol_dml_decimal_1_prt_partthree
NOTICE:  drop cascades to constraint computedcol_dml_decimal_1_prt_partthree_check on table computedcol_dml_decimal_1_prt_partthree
NOTICE:  drop cascades to append only table computedcol_dml_decimal_1_prt_parttwo
NOTICE:  drop cascades to constraint computedcol_dml_decimal_1_prt_parttwo_check on append only table computedcol_dml_decimal_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table computedcol_dml_decimal_1_prt_partone
NOTICE:  drop cascades to constraint computedcol_dml_decimal_1_prt_partone_check on append only columnar table computedcol_dml_decimal_1_prt_partone
NOTICE:  drop cascades to table computedcol_dml_decimal_1_prt_def
NOTICE:  drop cascades to table computedcol_dml_decimal
NOTICE:  drop cascades to table colalias_dml_timestamptz_candidate
NOTICE:  drop cascades to table colalias_dml_timestamptz_1_prt_def
NOTICE:  drop cascades to table colalias_dml_timestamptz
NOTICE:  drop cascades to table colalias_dml_timestamp_candidate
NOTICE:  drop cascades to table colalias_dml_timestamp_1_prt_def
NOTICE:  drop cascades to table colalias_dml_timestamp
NOTICE:  drop cascades to table colalias_dml_time_candidate
NOTICE:  drop cascades to table colalias_dml_time_1_prt_def
NOTICE:  drop cascades to table colalias_dml_time
NOTICE:  drop cascades to table colalias_dml_numeric_candidate
NOTICE:  drop cascades to table colalias_dml_numeric_1_prt_def
NOTICE:  drop cascades to table colalias_dml_numeric
NOTICE:  drop cascades to table colalias_dml_interval_candidate
NOTICE:  drop cascades to table colalias_dml_interval_1_prt_def
NOTICE:  drop cascades to table colalias_dml_interval
NOTICE:  drop cascades to table colalias_dml_int8_candidate
NOTICE:  drop cascades to table colalias_dml_int8_1_prt_def
NOTICE:  drop cascades to table colalias_dml_int8
NOTICE:  drop cascades to table colalias_dml_int4_candidate
NOTICE:  drop cascades to table colalias_dml_int4_1_prt_def
NOTICE:  drop cascades to table colalias_dml_int4
NOTICE:  drop cascades to table colalias_dml_int_candidate
NOTICE:  drop cascades to table colalias_dml_int_1_prt_def
NOTICE:  drop cascades to table colalias_dml_int
NOTICE:  drop cascades to table colalias_dml_float_candidate
NOTICE:  drop cascades to table colalias_dml_float_1_prt_def
NOTICE:  drop cascades to table colalias_dml_float
NOTICE:  drop cascades to table colalias_dml_decimal_candidate
NOTICE:  drop cascades to table colalias_dml_decimal_1_prt_def
NOTICE:  drop cascades to table colalias_dml_decimal
NOTICE:  drop cascades to table colalias_dml_date_candidate
NOTICE:  drop cascades to table colalias_dml_date_1_prt_def
NOTICE:  drop cascades to table colalias_dml_date
NOTICE:  drop cascades to table colalias_dml_char_candidate
NOTICE:  drop cascades to table colalias_dml_char_1_prt_def
NOTICE:  drop cascades to table colalias_dml_char
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_timestamptz
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_timestamp
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_time
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_timestamptz
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_timestamp
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_time
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_numeric
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_interval
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_int8
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_int4
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_int
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_float
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_decimal
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_date
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_random_char
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_numeric
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_interval
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_int8
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_int4
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_int
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_float
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_decimal
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_date
NOTICE:  drop cascades to table changedistpolicy_dml_regtab_char
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_timestamptz_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_timestamptz_1_prt_partthree_check on table changedistpolicy_dml_pttab_timestamptz_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_timestamptz_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_timestamptz_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_timestamptz_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_timestamptz_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_timestamptz_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_timestamptz_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_timestamptz
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_timestamp_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_timestamp_1_prt_partthree_check on table changedistpolicy_dml_pttab_timestamp_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_timestamp_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_timestamp_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_timestamp_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_timestamp_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_timestamp_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_timestamp_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_timestamp
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_time_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_time_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_time_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_time_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_time_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_time_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_time_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_time_1_prt_partthree_check on table changedistpolicy_dml_pttab_time_1_prt_partthree
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_time
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_numeric_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_numeric_1_prt_partthree_check on table changedistpolicy_dml_pttab_numeric_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_numeric_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_numeric_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_numeric_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_numeric_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_numeric_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_numeric_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_numeric
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_interval_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_interval_1_prt_partthree_check on table changedistpolicy_dml_pttab_interval_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_interval_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_interval_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_interval_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_interval_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_interval_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_interval_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_interval
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_int8_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int8_1_prt_partthree_check on table changedistpolicy_dml_pttab_int8_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_int8_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int8_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_int8_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_int8_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int8_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_int8_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_int8
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_int4_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int4_1_prt_partthree_check on table changedistpolicy_dml_pttab_int4_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_int4_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int4_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_int4_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_int4_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int4_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_int4_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_int4
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_int_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int_1_prt_partthree_check on table changedistpolicy_dml_pttab_int_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_int_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_int_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_int_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_int_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_int_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_int
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_float_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_float_1_prt_partthree_check on table changedistpolicy_dml_pttab_float_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_float_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_float_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_float_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_float_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_float_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_float_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_float
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_decimal_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_decimal_1_prt_partthree_check on table changedistpolicy_dml_pttab_decimal_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_decimal_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_decimal_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_decimal_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_decimal_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_decimal_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_decimal_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_decimal
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_date_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_date_1_prt_partthree_check on table changedistpolicy_dml_pttab_date_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_date_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_date_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_date_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_date_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_date_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_date_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_date
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_char_1_prt_partthree
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_char_1_prt_partthree_check on table changedistpolicy_dml_pttab_char_1_prt_partthree
NOTICE:  drop cascades to append only table changedistpolicy_dml_pttab_char_1_prt_parttwo
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_char_1_prt_parttwo_check on append only table changedistpolicy_dml_pttab_char_1_prt_parttwo
NOTICE:  drop cascades to append only columnar table changedistpolicy_dml_pttab_char_1_prt_partone
NOTICE:  drop cascades to constraint changedistpolicy_dml_pttab_char_1_prt_partone_check on append only columnar table changedistpolicy_dml_pttab_char_1_prt_partone
NOTICE:  drop cascades to table changedistpolicy_dml_pttab_char
INFO:  Distributed transaction command 'Distributed Prepare' to ALL contents
INFO:  Distributed transaction command 'Distributed Commit Prepared' to ALL contents
-- end_ignore
